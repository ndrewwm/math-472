<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrew Moore">
<meta name="description" content="My running notes during MATH-472 lectures.">

<title>math-472 - MATH-472: Class Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">math-472</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./class-notes.html" aria-current="page">
 <span class="menu-text">Class Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./homework.html">
 <span class="menu-text">Homework</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#section" id="toc-section" class="nav-link active" data-scroll-target="#section">1/10/23</a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1">1/12/23</a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2">1/17/23</a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3">1/19/23</a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4">1/24/23</a></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5">1/26/23</a></li>
  <li><a href="#section-6" id="toc-section-6" class="nav-link" data-scroll-target="#section-6">1/31/23</a></li>
  <li><a href="#section-7" id="toc-section-7" class="nav-link" data-scroll-target="#section-7">2/2/2023</a></li>
  <li><a href="#section-8" id="toc-section-8" class="nav-link" data-scroll-target="#section-8">2/7/2022</a></li>
  <li><a href="#section-9" id="toc-section-9" class="nav-link" data-scroll-target="#section-9">2/9/2023</a></li>
  <li><a href="#section-10" id="toc-section-10" class="nav-link" data-scroll-target="#section-10">2/21/23</a></li>
  <li><a href="#section-11" id="toc-section-11" class="nav-link" data-scroll-target="#section-11">2/23/23</a></li>
  <li><a href="#section-12" id="toc-section-12" class="nav-link" data-scroll-target="#section-12">2/28/23</a></li>
  <li><a href="#section-14" id="toc-section-14" class="nav-link" data-scroll-target="#section-14">3/2/23</a></li>
  <li><a href="#section-15" id="toc-section-15" class="nav-link" data-scroll-target="#section-15">3/7/2023</a></li>
  <li><a href="#section-16" id="toc-section-16" class="nav-link" data-scroll-target="#section-16">3/9/2023</a></li>
  <li><a href="#section-17" id="toc-section-17" class="nav-link" data-scroll-target="#section-17">3/14/23</a></li>
  <li><a href="#section-18" id="toc-section-18" class="nav-link" data-scroll-target="#section-18">3/17/23</a></li>
  <li><a href="#section-19" id="toc-section-19" class="nav-link" data-scroll-target="#section-19">3/28/23</a></li>
  <li><a href="#section-20" id="toc-section-20" class="nav-link" data-scroll-target="#section-20">4/4/23</a></li>
  <li><a href="#section-21" id="toc-section-21" class="nav-link" data-scroll-target="#section-21">4/6/23</a></li>
  <li><a href="#section-22" id="toc-section-22" class="nav-link" data-scroll-target="#section-22">4/11/23</a></li>
  <li><a href="#section-23" id="toc-section-23" class="nav-link" data-scroll-target="#section-23">4/13/23</a></li>
  <li><a href="#section-24" id="toc-section-24" class="nav-link" data-scroll-target="#section-24">4/18/23</a></li>
  <li><a href="#section-25" id="toc-section-25" class="nav-link" data-scroll-target="#section-25">4/20/23</a></li>
  <li><a href="#section-26" id="toc-section-26" class="nav-link" data-scroll-target="#section-26">4/25/23</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">MATH-472: Class Notes</h1>
</div>

<div>
  <div class="description">
    <p>My running notes during MATH-472 lectures.</p>
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andrew Moore </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell">

</div>
<section id="section" class="level1">
<h1>1/10/23</h1>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>Overview of syllabus. Covered introduction to R.</p>
</section>
<section id="notes" class="level2">
<h2 class="anchored" data-anchor-id="notes">Notes</h2>
<ul>
<li>basic operators
<ul>
<li><code>+ / - * ^ = &lt;-</code></li>
</ul></li>
<li>logical operators</li>
<li>assignment (Dr.&nbsp;Ko prefers <code>&lt;-</code>)</li>
<li><code>sum()</code>, <code>length()</code>, <code>c()</code></li>
<li>definition of functions</li>
<li>if/then</li>
</ul>
</section>
</section>
<section id="section-1" class="level1">
<h1>1/12/23</h1>
<section id="summary-1" class="level2">
<h2 class="anchored" data-anchor-id="summary-1">Summary</h2>
<p>More preamble. Should’ve skipped, no new material, painful.</p>
</section>
<section id="notes-1" class="level2">
<h2 class="anchored" data-anchor-id="notes-1">Notes</h2>
<p>Continuing where we left off. If/else statements.</p>
<ul>
<li><code>ifelse()</code>
<ul>
<li>you can do assignment inside of this (wild, seems inadvisible, but neat)</li>
<li>e.g.&nbsp;<code>ifelse(1 &gt; 2, x &lt;- 1, x &lt;- 0)</code></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>ex2 <span class="ot">&lt;-</span> <span class="dv">76</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  ex2 <span class="sc">&gt;=</span> <span class="dv">90</span>, grade <span class="ot">&lt;-</span> <span class="st">'A'</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    ex2 <span class="sc">&gt;=</span> <span class="dv">80</span>, grade <span class="ot">&lt;-</span> <span class="st">'B'</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(ex2 <span class="sc">&gt;=</span> <span class="dv">70</span>, grade <span class="ot">&lt;-</span> <span class="st">'C'</span>, <span class="st">''</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C"</code></pre>
</div>
</div>
<ul>
<li>Arrays: used to store results of computations
<ul>
<li>one dimension: vectors e.g.&nbsp;<code>x &lt;- numeric(k)</code> for a numeric vector of size <code>k</code></li>
<li>two dimensions: matrices
<ul>
<li><span class="math inline">\(A_{2 \times 3}\)</span></li>
<li>e.g.&nbsp;<code>y &lt;- matrix(0, nrow = m, ncol = n)</code> for a <code>m</code> x <code>n</code> 0 matrix.</li>
</ul></li>
<li>more dimensions
<ul>
<li>e.g.&nbsp;<code>l &lt;- array(0, dim = c(m, n, ...))</code></li>
</ul></li>
</ul></li>
<li>covered indexing with matrices using bracket notation</li>
</ul>
<section id="loops" class="level3">
<h3 class="anchored" data-anchor-id="loops">Loops</h3>
<p>For loops</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> k <span class="sc">+</span> i</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>k</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> x) {</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> k <span class="sc">+</span> x[i]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>k</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55</code></pre>
</div>
</div>
<p>While loops</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (i <span class="sc">&lt;=</span> <span class="dv">10</span>) {</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> k <span class="sc">+</span> i</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>k; i</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11</code></pre>
</div>
</div>
</section>
<section id="practice-create-a-function-that-computes-an-average-without-using-sum-or-mean" class="level3">
<h3 class="anchored" data-anchor-id="practice-create-a-function-that-computes-an-average-without-using-sum-or-mean">Practice, create a function that computes an average without using <code>sum()</code> or <code>mean()</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>avg <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> x) s <span class="ot">&lt;-</span> s <span class="sc">+</span> i</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  s <span class="sc">/</span> i</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">avg</span>(x) <span class="sc">==</span> <span class="fl">5.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="ifelse-is-vectorized-if-is-not" class="level3">
<h3 class="anchored" data-anchor-id="ifelse-is-vectorized-if-is-not"><code>ifelse()</code> is vectorized, <code>if</code> is not</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>score <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">76</span>, <span class="dv">92</span>, <span class="dv">83</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>grade <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  score <span class="sc">&gt;=</span> <span class="dv">90</span>, <span class="st">'A'</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(score <span class="sc">&gt;=</span> <span class="dv">80</span>, <span class="st">'B'</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ifelse</span>(score <span class="sc">&gt;=</span> <span class="dv">70</span>, <span class="st">'C'</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>grade</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C" "A" "B"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># will fail-- length(score) &gt; 1</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># if (score &gt;= 90) {</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   grade &lt;- 'A'</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># } else if (score &gt;= 80) {</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   grade &lt;- 'B'</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># } else {</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   grade &lt;- 'C'</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="note-on-statistical-software" class="level3">
<h3 class="anchored" data-anchor-id="note-on-statistical-software">Note on statistical software</h3>
<ul>
<li><p>R adapted from S Plus.</p></li>
<li><p>Dr.&nbsp;Ko says this should be enough for us to cover the programming we’ll use this semester.</p>
<ul>
<li>recommends learning branching and loop syntax for adapting to other languages.</li>
</ul></li>
</ul>
</section>
<section id="textbook-chapter-2-probability-and-statistics-review" class="level3">
<h3 class="anchored" data-anchor-id="textbook-chapter-2-probability-and-statistics-review">Textbook chapter 2, Probability and Statistics Review</h3>
<ul>
<li><strong>Random variable</strong>: assigns outcomes in a sample space <span class="math inline">\(\rightarrow\)</span> Real numbers
<ul>
<li>describes behavior of population elements</li>
<li><strong>Probability Density Function</strong> (pdf)
<ul>
<li><span class="math inline">\(f_X(x)\)</span></li>
</ul></li>
<li><strong>Cumulative Distribution Function</strong> (cdf)
<ul>
<li><span class="math inline">\(F_X(x) \equiv P[X \leq x]\)</span></li>
<li>non-decreasing function: <span class="math inline">\(x_1 &lt; x_2 \iff F_X(x_1) \leq F_X(x_2)\)</span></li>
<li>right-continuous: <span class="math inline">\(\lim_{\epsilon \to 0^{+}} F_X(x + \epsilon) = F_X(x), x \in \mathbb{R}\)</span></li>
<li><span class="math inline">\(\lim_{x \to \infty} F_X(x) = 1, \lim_{x \to -\infty} F_X(x) = 0\)</span>.</li>
<li>CDFs for discrete functions are step functions.</li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
</section>
<section id="section-2" class="level1">
<h1>1/17/23</h1>
<ul>
<li>Absent</li>
</ul>
</section>
<section id="section-3" class="level1">
<h1>1/19/23</h1>
<ul>
<li>Absent</li>
</ul>
</section>
<section id="section-4" class="level1">
<h1>1/24/23</h1>
<section id="summary-2" class="level2">
<h2 class="anchored" data-anchor-id="summary-2">Summary</h2>
<p>Discussing MLE, analytical solutions vs.&nbsp;numerical solutions.</p>
</section>
<section id="notes-2" class="level2">
<h2 class="anchored" data-anchor-id="notes-2">Notes</h2>
<p>Review of analytical MLE is done in my notebook. Numerical estimation can be done using the <code>mle()</code> function, which is from the <code>stats4</code> package. This approach is only possible if we know the definition of the negative-loglik function. Also, depending on the starting value, it may take time for <code>mle()</code> to produce an estimate.</p>
<p>What kind of search is <code>mle()</code> using? It depends on <code>optim()</code>… which uses an implementation of <em>Nelder and Mead (1965).</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats4)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># y &lt;- c(0.04304550, 0.50263474)</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>mlogl <span class="ot">&lt;-</span> <span class="cf">function</span>(theta) <span class="sc">-</span>(<span class="fu">length</span>(y)<span class="sc">*</span><span class="fu">log</span>(theta) <span class="sc">-</span> theta<span class="sc">*</span><span class="fu">sum</span>(y))</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">mle</span>(mlogl, <span class="fl">1.4</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Maximum likelihood estimation

Call:
mle(minuslogl = mlogl, start = 1.4)

Coefficients:
      Estimate Std. Error
[1,] 0.4000004  0.1999989

-2 log L: 15.33033 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4</code></pre>
</div>
</div>
</section>
</section>
<section id="section-5" class="level1">
<h1>1/26/23</h1>
<section id="summary-3" class="level2">
<h2 class="anchored" data-anchor-id="summary-3">Summary</h2>
<p>Two parameter MLE, <code>optim()</code>, Inverse Transform Method</p>
</section>
<section id="notes-3" class="level2">
<h2 class="anchored" data-anchor-id="notes-3">Notes</h2>
<ul>
<li>data analysis: you have a sample
<ul>
<li>need to infer <em>population distribution function</em></li>
<li>need to infer <em>parameters</em> of the distribution function</li>
<li>together, you use them to</li>
</ul></li>
<li>MLE: used for parametric inference
<ul>
<li>MLE requires sample to be random/iid (likelihood function is a joint probability distribution). What if it’s not?</li>
</ul></li>
<li>Today we’re looking at random number generation?</li>
</ul>
<section id="two-parameter-mle" class="level3">
<h3 class="anchored" data-anchor-id="two-parameter-mle">Two-parameter MLE</h3>
<p>Suppose we have <span class="math inline">\(x_1, x_2, ..., x_n \sim Gamma(\lambda, r)\)</span>, with pdf <span class="math display">\[
f(x; \lambda, r) = \begin{cases} \frac{\lambda}{\Gamma(r)} x^{r - 1} e^{-\lambda x}  &amp; x \geq 0, r &gt; 0, \lambda &gt; 0 \\ 0, &amp; \text{otherwise} \end{cases}$
\]</span></p>
<p>Note: <span class="math display">\[
\Gamma(r) = \int_0^\infty t^{r - 1} e^{-t}\ dt, t \geq 0.
\]</span></p>
<p>For a positive real number <span class="math inline">\(r\)</span>, <span class="math inline">\(\Gamma(r + 1) = r \cdot \Gamma(r).\)</span></p>
<p>Note: <span class="math inline">\(n! = \Gamma(n + 1)\)</span> because <span class="math inline">\(\Gamma(r + 1) = r \cdot \Gamma(r)\)</span>.</p>
</section>
<section id="the-optim-function-for-mle-with-1-parameter" class="level3">
<h3 class="anchored" data-anchor-id="the-optim-function-for-mle-with-1-parameter">the <code>optim()</code> function for MLE with &gt;1 parameter</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5928</span>, <span class="fl">3.2048</span>, <span class="fl">2.2281</span>, <span class="fl">4.2292</span>, <span class="fl">1.2096</span>, <span class="fl">3.8371</span>, <span class="fl">1.2670</span>, <span class="fl">1.2042</span>, <span class="fl">2.8182</span>, <span class="fl">3.5173</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>ll <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, sumx, sumlogx, n) {</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> theta[<span class="dv">1</span>]</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> theta[<span class="dv">2</span>]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span>(n<span class="sc">*</span>r<span class="sc">*</span><span class="fu">log</span>(lambda) <span class="sc">-</span> n<span class="sc">*</span><span class="fu">log</span>(<span class="fu">gamma</span>(r)) <span class="sc">+</span> (r <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">*</span>sumlogx <span class="sc">-</span> lambda<span class="sc">*</span>sumx)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="fu">optim</span>(<span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">19</span>), ll, <span class="at">sumx =</span> <span class="fu">sum</span>(x), <span class="at">sumlogx =</span> <span class="fu">sum</span>(<span class="fu">log</span>(x)), <span class="at">n =</span> <span class="fu">length</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$par
[1] 3.161073 1.311199

$value
[1] 16.09232

$counts
function gradient 
      81       NA 

$convergence
[1] 0

$message
NULL</code></pre>
</div>
</div>
<ul>
<li>even when estimating parameters numerically, you still need to be able to derive the log-likelihood function for the sample’s distribution (or <em>assumed</em> distribution)</li>
</ul>
</section>
<section id="inverse-transform-method" class="level3">
<h3 class="anchored" data-anchor-id="inverse-transform-method">Inverse Transform Method</h3>
<ol type="1">
<li>continuous random variables</li>
</ol>
<ul>
<li><span class="math inline">\(U\)</span> is a uniform r.v. over <span class="math inline">\((a, b)\)</span> if its pdf is <span class="math inline">\(f_U(u) = \frac{1}{b-1}, a &lt; u &lt; b \text{ and } 0 \text{ otherwise}.\)</span></li>
</ul>
<ol start="2" type="1">
<li>discrete random variables</li>
</ol>
</section>
</section>
</section>
<section id="section-6" class="level1">
<h1>1/31/23</h1>
<section id="summary-4" class="level2">
<h2 class="anchored" data-anchor-id="summary-4">Summary</h2>
<p>More on the Inverse Transform Method.</p>
</section>
<section id="notes-4" class="level2">
<h2 class="anchored" data-anchor-id="notes-4">Notes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># given an exponential distribution</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>exp_pdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x) lambda<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>x)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>inv_exp <span class="ot">&lt;-</span> <span class="cf">function</span>(u) <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>lambda <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100000</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">inv_exp</span>(u)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x) <span class="co"># should be close to 1 / lambda</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09966128</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(x) <span class="co"># should be close to 1 / lambda^2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01001022</code></pre>
</div>
</div>
<p>Transformation of a discrete CDF via a quantile:</p>
<p><span class="math inline">\(y_i\)</span> is the random variable corresponding to <span class="math inline">\(u\)</span> if <span class="math display">\[
F_Y(y_{i - 1}) &lt; u \leq F_Y(y_i), u \sim Uniform(0, 1)
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transformation given a discrete CDF, using quantiles</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  cdf <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.36</span>, <span class="fl">0.42</span>, <span class="fl">0.85</span>, <span class="dv">1</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    u <span class="sc">&lt;=</span> cdf[<span class="dv">1</span>]              <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    u <span class="sc">&gt;</span> cdf[<span class="dv">1</span>] <span class="sc">&amp;</span> u <span class="sc">&lt;=</span> cdf[<span class="dv">2</span>] <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    u <span class="sc">&gt;</span> cdf[<span class="dv">2</span>] <span class="sc">&amp;</span> u <span class="sc">&lt;=</span> cdf[<span class="dv">3</span>] <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    u <span class="sc">&gt;</span> cdf[<span class="dv">3</span>] <span class="sc">&amp;</span> u <span class="sc">&lt;=</span> cdf[<span class="dv">4</span>] <span class="sc">~</span> <span class="dv">3</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    u <span class="sc">&gt;</span> cdf[<span class="dv">4</span>] <span class="sc">&amp;</span> u <span class="sc">&lt;=</span> cdf[<span class="dv">5</span>] <span class="sc">~</span> <span class="dv">4</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_real_</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">table</span>(<span class="fu">g</span>(<span class="dv">10000</span>)))</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cumsum</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     0      1      2      3      4 
0.0945 0.3614 0.4230 0.8509 1.0000 </code></pre>
</div>
</div>
</section>
</section>
<section id="section-7" class="level1">
<h1>2/2/2023</h1>
<section id="summary-5" class="level2">
<h2 class="anchored" data-anchor-id="summary-5">Summary</h2>
<p>Process of computational methods, acceptance-rejection method</p>
</section>
<section id="notes-5" class="level2">
<h2 class="anchored" data-anchor-id="notes-5">Notes</h2>
<p><em>Process of computational methods</em></p>
<ol type="1">
<li><p>Estimate population distribution</p></li>
<li><p>Get point estimates of parameters</p></li>
<li><p>Simulate realizations from the population distribution</p></li>
</ol>
<ul>
<li>These realizations can then be used to test statistical methods/tools, etc.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">p =</span> <span class="fl">0.4</span>) p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p)<span class="sc">^</span>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What if we can’t calculate a closed form of a CDF? Then, we can’t do a tidy inverse transform…</p>
<section id="acceptance-rejection-method" class="level3">
<h3 class="anchored" data-anchor-id="acceptance-rejection-method">Acceptance-Rejection Method</h3>
<p>We want realizations from a r.v. <span class="math inline">\(X\)</span>, with pdf <span class="math inline">\(f_X(x)\)</span>, but suppose it is hard to generate them. If we can find another pdf <span class="math inline">\(g_X(x)\)</span></p>
<ol type="1">
<li><p>which is defined on the same support of <span class="math inline">\(f_X(x)\)</span></p></li>
<li><p>from which it is easy to generate realizations,</p></li>
</ol>
<p>and if we can find a constant <span class="math inline">\(c &gt; 1\)</span> such that</p>
<p><span class="math display">\[
h(x) = c \cdot g_X(x) \geq f_X(x)
\]</span></p>
<p>or</p>
<p><span class="math display">\[
\frac{f_X(x)}{g_X(x)} \leq c,
\]</span></p>
<p>then, we can generate a realization <span class="math inline">\(x\)</span> from <span class="math inline">\(f_X(x)\)</span> using the following algorithm:</p>
<ol type="1">
<li>Generate a realization <span class="math inline">\(y\)</span> from <span class="math inline">\(g_X(x)\)</span>.</li>
<li>Generate a uniform random number <span class="math inline">\(u\)</span> from <span class="math inline">\(U(0, 1)\)</span>.</li>
<li>Set <span class="math inline">\(y\)</span> to <span class="math inline">\(x\)</span> if <span class="math inline">\(u &lt; \frac{f_X(y)}{c\cdot g_X(y)}.\)</span> Otherwise go back to step 1.</li>
</ol>
<p>Then, <span class="math inline">\(x\)</span> is a random number with the pdf <span class="math inline">\(f_X(x)\)</span>.</p>
<p>Probability that a point from step 1 is rejected is</p>
<p><span class="math display">\[
P(\text{A point generated from step 1 is rejected}) = \frac{\text{Area between } h(x) \text{and } f(x)}{\text{Area under } h(x)}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># demonstrate acception-rejection method using a Beta(2, 1) distribution</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># g(x) = Uniform(0, 1)</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">2</span><span class="sc">*</span>x</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">1</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>gen_beta <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  u1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  u2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># if accepted,</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">f</span>(u1) <span class="sc">/</span> (C <span class="sc">*</span> <span class="fu">g</span>(u1))</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"r"</span> <span class="ot">=</span> r, <span class="st">"u1"</span> <span class="ot">=</span> u1, <span class="st">"u2"</span> <span class="ot">=</span> u2)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (u2 <span class="sc">&lt;</span> <span class="fu">f</span>(u1) <span class="sc">/</span> (C <span class="sc">*</span> <span class="fu">g</span>(u1))) {</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(u1)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gen_beta</span>()</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">gen_beta</span>())</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>x_actual <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1000</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-notes_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x_actual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-notes_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="section-8" class="level1">
<h1>2/7/2022</h1>
<section id="summary-6" class="level2">
<h2 class="anchored" data-anchor-id="summary-6">Summary</h2>
<p>Acceptance-rejection method for discrete random variables</p>
</section>
<section id="notes-6" class="level2">
<h2 class="anchored" data-anchor-id="notes-6">Notes</h2>
<p>Acceptance-rejection method for discrete random variables.</p>
<p>Let <span class="math inline">\(f_X(x) = \begin{cases} 0.16, x = 1 \\ 0.24, x = 2 \\ 0.33, x = 3 \\ 0.17, x = 4 \\ 0.10, x = 5 \\ 0, \text{ otherwise}. \end{cases}\)</span> Assume we also have <span class="math inline">\(g_X(x) = \frac{1}{5}, x \in \{1, 2, 3, 4, 5\} \text{ and } 0 \text{ otherwise}.\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.16</span>, <span class="fl">0.24</span>, <span class="fl">0.33</span>, <span class="fl">0.17</span>, <span class="fl">0.10</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">5</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">max</span>(f <span class="sc">/</span> g)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>f_x <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="fl">0.16</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="fl">0.24</span>,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="fl">0.33</span>,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="fl">0.17</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="fl">0.10</span>,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>gen <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span>) <span class="co"># draw 1 realization from discrete uniform</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># draw 1 realization from continuous uniform</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (u <span class="sc">&lt;=</span> <span class="fu">f_x</span>(y) <span class="sc">/</span> (C <span class="sc">*</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>)) {</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(y)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gen</span>()</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">gen</span>())</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(out))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>out
    1     2     3     4     5 
0.148 0.243 0.334 0.174 0.101 </code></pre>
</div>
</div>
</section>
</section>
<section id="section-9" class="level1">
<h1>2/9/2023</h1>
<section id="summary-7" class="level2">
<h2 class="anchored" data-anchor-id="summary-7">Summary</h2>
<p>Covering random processes (counting processes, poisson processes, renewal processes).</p>
</section>
<section id="notes-7" class="level2">
<h2 class="anchored" data-anchor-id="notes-7">Notes</h2>
<ul>
<li>random processes depend on an <strong>index</strong>, often <em>time</em></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>gen_poisson <span class="ot">&lt;-</span> <span class="cf">function</span>(t0, lambda) {</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="dv">0</span>; i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (s <span class="sc">&lt;=</span> t0) {</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    t <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u) <span class="sc">/</span> lambda  <span class="co"># inverse transform to draw from Exp(lambda)</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">&lt;-</span> s <span class="sc">+</span> t</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(i <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="fu">gen_poisson</span>(<span class="dv">10</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">gen_poisson</span>(<span class="dv">8</span>, <span class="dv">3</span>))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-notes_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="section-10" class="level1">
<h1>2/21/23</h1>
<section id="summary-8" class="level2">
<h2 class="anchored" data-anchor-id="summary-8">Summary</h2>
<p>Monte-Carlo Integration, <code>rnorm()</code>, <code>qnorm()</code>, etc.</p>
</section>
<section id="notes-8" class="level2">
<h2 class="anchored" data-anchor-id="notes-8">Notes</h2>
<ul>
<li><p>We’ll get back the exam results this Thursday.</p>
<ul>
<li>We’ll have a chance to correct scores (if they’re really bad?)</li>
</ul></li>
<li><p>We’re skipping chapter 5 (which covers data visualization), and move to chapter 6</p></li>
<li><p>Chapter 6 utilizes the process of generating random numbers (ch.&nbsp;3), but we won’t use methods such as inverse-transform; we’ll use built-in methods from R</p></li>
</ul>
<p><span class="math inline">\(x_1, x_2, \cdots, x_n \sim Exp(\lambda)\)</span></p>
<p><span class="math display">\[
f_X(x) = \begin{cases}
  \lambda \cdot e^{-\lambda x} &amp; x \geq 0, \lambda &gt; 0 \\
  0 &amp; \text{ otherwise.}
\end{cases}
\]</span></p>
<p><span class="math inline">\(u \equiv F_X(x) = 1 - e^{-\lambda x}\)</span> <span class="math inline">\(x \to -\frac{1}{\lambda}ln(1 - u)\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rexp</span>(n, lambda) <span class="co"># x_i ~ f(x)             -- random draws</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.16743738 0.11545642 0.77955957 0.19226185 0.92408510 1.19061335
 [7] 0.06183609 1.14527279 0.56107668 0.13444328</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pexp</span>(x, lambda) <span class="co"># P(X &lt;= x)              -- CDF, cumulative probability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9502129</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dexp</span>(x, lambda) <span class="co"># P(X == x)?             -- density</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1493612</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qexp</span>(p, lambda) <span class="co"># x* s.t. P(X &lt;= x*) = p -- quantile</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4013243</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>, mu, sd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1788599</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">5</span>, mu, sd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.75</span>, mu, sd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.023469</code></pre>
</div>
</div>
<ul>
<li>covering use of <code>set.seed()</code></li>
</ul>
<p>Example. Suppose <span class="math inline">\(u \sim U(0, 1)\)</span>, and <span class="math display">\[
F_u(u^*) \equiv P(U \leq u^*) = \int_0^{u^*} f_u(u)\ du = \int_0^{u^*} 1\ du = u^*
\]</span></p>
<p>Demonstration of theorem, using <span class="math inline">\(punif()\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">punif</span>(<span class="fl">0.6</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6</code></pre>
</div>
</div>
<section id="monte-carlo-integration" class="level3">
<h3 class="anchored" data-anchor-id="monte-carlo-integration">Monte Carlo Integration</h3>
<!-- hell yea, new topics -->
<p><span class="math display">\[
\int_0^1 e^{-x}\ dx
\]</span></p>
<p>In numerical integration (Simpson’s rule, midpoint rule, etc.), you can learn to integrate something like the above.</p>
<p>However, in statistics, we accomplish this by generating random numbers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000000</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">exp</span>(<span class="sc">-</span>u))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6319535</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6321206</code></pre>
</div>
</div>
<p>Monte Carlo integration relies on the <em>Strong Law of Large Numbers.</em></p>
<p>Let <span class="math inline">\(g(x)\)</span> be a function of random variable <span class="math inline">\(X\)</span> with pdf <span class="math inline">\(f_X(x)\)</span>. Then let <span class="math display">\[
\theta = E(g(X)) = \int_{-\infty}^{\infty} g(x)f_X(x)\ dx
\]</span></p>
<p>If one has a random sample of size <span class="math inline">\(n\)</span>, <span class="math inline">\(x_1, x_2, \cdots, x_n\)</span> from <span class="math inline">\(f_X(x)\)</span>, then <span class="math inline">\(\hat{\theta} = \sum_{i = 1}^{n} g(x_i) / n\)</span> converges to <span class="math inline">\(\theta\)</span> with probability 1 by the Strong Law of Large Numbers.</p>
<p>Example:</p>
<p><span class="math display">\[
\theta = E(g(X)) = \int_0^1 x\ dx = \int_0^1 x \cdot \frac{1}{1 - 0}\ dx = \frac{1}{2}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>u1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n1, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>u2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n2, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># g(x) = x</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(u1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4879659</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(u2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4989732</code></pre>
</div>
</div>
<p><span class="math display">\[
\theta = \int_a^b g(x)\ dx = (b - a) \cdot \int_a^b g(x) \cdot \frac{1}{b - a}\ dx
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">5</span>) <span class="sc">-</span> (<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1285973</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>(<span class="dv">5</span> <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">mean</span>(<span class="fu">exp</span>(<span class="sc">-</span>u))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1299476</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="section-11" class="level1">
<h1>2/23/23</h1>
<section id="summary-9" class="level2">
<h2 class="anchored" data-anchor-id="summary-9">Summary</h2>
<p>More on Monte-Carlo integration, discussion of why sample mean is preferred vs.&nbsp;other estimators wrt the law of large numbers.</p>
</section>
<section id="notes-9" class="level2">
<h2 class="anchored" data-anchor-id="notes-9">Notes</h2>
<ul>
<li><p>turn in corrections to your exam to Dr.&nbsp;Ko’s office, by 12pm tomorrow.</p></li>
<li><p>Why do we like the sample mean (for estimating <span class="math inline">\(\mu\)</span>)?</p>
<ul>
<li>it uses the same formula! this is why the strong law of large numbers is powerful</li>
<li>sample median won’t necessarily converge to population mean, e.g.&nbsp;when the population distribution isn’t symmetric</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>mc_integrate <span class="ot">&lt;-</span> <span class="cf">function</span>(g, <span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, n) {</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, a, b)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  (b <span class="sc">-</span> a) <span class="sc">*</span> <span class="fu">mean</span>(<span class="fu">g</span>(u))</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>, <span class="dv">10000</span>, <span class="dv">100000</span>), <span class="sc">~</span><span class="fu">mc_integrate</span>(f, <span class="dv">2</span>, <span class="dv">4</span>, .))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09562651 0.10850361 0.11208910 0.11700866 0.11717136</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># true value</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1170196</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">10</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">10</span> <span class="sc">*</span> x)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">1000</span>, <span class="dv">1000000</span>), <span class="sc">~</span><span class="fu">mc_integrate</span>(h, <span class="dv">0</span>, <span class="dv">2</span>, .))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01468095 0.98138915 1.00302424</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># true value</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(h, <span class="dv">0</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 with absolute error &lt; 1.5e-07</code></pre>
</div>
</div>
<p>Currently, we’ve been checking the difference between our estimates and the true value. This is a measure of <em>bias</em> against true parameter values. However, we’ll discuss measurements of variance in a future class.</p>
</section>
</section>
<section id="section-12" class="level1">
<h1>2/28/23</h1>
<section id="summary-10" class="level2">
<h2 class="anchored" data-anchor-id="summary-10">Summary</h2>
</section>
<section id="notes-10" class="level2">
<h2 class="anchored" data-anchor-id="notes-10">Notes</h2>
<ul>
<li>Homework 3 assigned</li>
<li>Exam corrections returned (I got 89%?)</li>
</ul>
<section id="section-13" class="level3">
<h3 class="anchored" data-anchor-id="section-13"></h3>
<p><span class="math inline">\(Pr(0 \leq x \leq 5)\)</span> where <span class="math display">\[
f_X(x) = \begin{cases}
10 \cdot e^{-10x}, &amp; x \geq 0 \\
0, &amp; \text{ otherwise}
\end{cases}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">10</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">10</span> <span class="sc">*</span> x)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mc_integrate</span>(f, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">100000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.009759</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>cdf_exp_b <span class="ot">&lt;-</span> <span class="cf">function</span>(x, lambda, n) {</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">*</span> <span class="fu">mean</span>(lambda <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> x <span class="sc">*</span> u))</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">cdf_exp_b</span>(<span class="dv">6</span>, <span class="dv">20</span>, <span class="dv">100</span>)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">cdf_exp_b</span>(<span class="dv">2</span>, <span class="dv">20</span>, <span class="dv">100</span>)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>u <span class="sc">-</span> l</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.5129175</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pexp</span>(<span class="dv">6</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>) <span class="sc">-</span> <span class="fu">pexp</span>(<span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1640192</code></pre>
</div>
</div>
</section>
<section id="example-from-class-write-a-function-to-generate-a-z-table" class="level3">
<h3 class="anchored" data-anchor-id="example-from-class-write-a-function-to-generate-a-z-table">Example from class: write a function to generate a Z-table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare results to textbook example 6.3</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>z_cdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">n =</span> <span class="dv">1000</span>) {</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># density of Z ~ N(0, 1)?</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> <span class="cf">function</span>(x, u) {</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi) <span class="sc">*</span> x <span class="sc">*</span> <span class="fu">exp</span>((<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> u<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Z ~ N(0, 1) is symmetric about 0</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (x <span class="sc">&gt;=</span> <span class="dv">0</span>) {</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.5</span> <span class="sc">+</span> <span class="fu">theta</span>(x, u)</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">-</span> <span class="fu">theta</span>(<span class="sc">-</span>x, u)</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a><span class="fu">z_cdf</span>(<span class="dv">2</span>, <span class="dv">100000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.977421</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9772499</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="section-14" class="level1">
<h1>3/2/23</h1>
<section id="summary-11" class="level2">
<h2 class="anchored" data-anchor-id="summary-11">Summary</h2>
<ul>
<li>“Hit or Miss” approach to Monte Carlo Integration</li>
</ul>
</section>
<section id="notes-11" class="level2">
<h2 class="anchored" data-anchor-id="notes-11">Notes</h2>
<p>Today: An easier way to generate CDFs for random variables?</p>
<p>“Hit or Miss” approach for Monte Carlo Integration.</p>
<p>Let <span class="math inline">\(f(x)\)</span> be the pdf of a random variable <span class="math inline">\(X\)</span>. To estimate <span class="math inline">\(F(x) = \int_{-\infty}^x f(t)\ dt\)</span> is</p>
<ol type="1">
<li>Generate a random sample <span class="math inline">\(X_1, X_2, \cdots, X_m\)</span> from <span class="math inline">\(f(x)\)</span>.</li>
<li>For each <span class="math inline">\(X_i\)</span>, compute <span class="math inline">\(g(x) = I(X_i \leq x) = \begin{cases} 1, &amp; X_i \leq x \\ 0, &amp; X_i &gt; x\end{cases}\)</span>.</li>
<li>Compute <span class="math inline">\(\hat{F}(x) = \bar{g(X)} = \frac{1}{m} \sum_{i = 1}^m I(X_i \leq x)\)</span> as an estimate of <span class="math inline">\(F(x)\)</span>.</li>
</ol>
<p>Note: <span class="math inline">\(\hat{F}(x)\)</span> is called the <em>empirical distribution</em> of <span class="math inline">\(F(x)\)</span>.</p>
<p>Why does this work?</p>
<p><span class="math inline">\(E(x) = 1 \cdot P(X \leq x) + 0 \cdot p(X &gt; x) = P(X \leq x) = F(x)\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the "Hit-or-Miss" method:</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># step 1.</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="co"># step 2. (an indicator function)</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> x <span class="sc">&lt;=</span> <span class="fl">1.96</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="co"># step 3.</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(i)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9797</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>norm_cdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">n =</span> <span class="dv">10000</span>, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">sigma =</span> <span class="dv">1</span>) {</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mu, sigma)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> X <span class="sc">&lt;=</span> x</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(i)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>exp_cdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">n =</span> <span class="dv">10000</span>, <span class="at">lambda =</span> <span class="dv">5</span>) {</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, lambda)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> X <span class="sc">&lt;=</span> x</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(i)</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="fu">exp_cdf</span>(<span class="fl">7.6</span>, <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">lambda =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pexp</span>(<span class="fl">7.6</span>, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>beta_cdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">n =</span> <span class="dv">10000</span>, <span class="at">a =</span> <span class="dv">2</span>, <span class="at">b =</span> <span class="dv">3</span>) {</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n, a, b)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> X <span class="sc">&lt;=</span> x</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(i)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="fu">beta_cdf</span>(<span class="fl">0.7</span>, <span class="at">a =</span> <span class="dv">2</span>, <span class="at">b =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9208</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbeta</span>(<span class="fl">0.7</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9163</code></pre>
</div>
</div>
<p>How do we choose between competing estimates for parameters <span class="math inline">\(\hat{\theta}\)</span>?</p>
<p>Say we have <span class="math inline">\(\hat{\theta_1}\)</span> and <span class="math inline">\(\hat{\theta_2}\)</span> as estimators (?) of <span class="math inline">\(\theta\)</span>. We care about:</p>
<ol type="1">
<li><em>Unbiasedness:</em> if <span class="math inline">\(E(\hat{\theta}) = \theta\)</span>, then <span class="math inline">\(\hat{\theta}\)</span> is an unbiased estimate.</li>
<li><em>Minimum Variance:</em> if <span class="math inline">\(Var(\hat{\theta_1}) &lt; Var(\hat{\theta_2})\)</span>, we would prefer <span class="math inline">\(\hat{\theta_1}\)</span>, other properties being equivalent.</li>
</ol>
<p>Developed estimators should satisfy these properties.</p>
<p>“Uniformly Most powerful Variance among Unbiased Estimates”: “UMVUE”.</p>
<p>Papers can be published based on whether a new estimator has less variance than an existing estimator.</p>
<p>How do we compare the variance of an estimator? Samples of samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare hit or miss vs. simple monte-carlo</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co"># theta_1 is simple monte-carlo</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co"># theta_2 is indicator</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co"># estimating F_Z(1.96) where Z ~ N(0, 1).</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="co"># generate 100 estimates of theta_1 and theta_2 (n = 10,000)</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="co"># then, take the variance of each</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="co"># for theta_1</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>z_cdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">n =</span> <span class="dv">1000</span>) {</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># density of Z ~ N(0, 1)?</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> <span class="cf">function</span>(x, u) {</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi) <span class="sc">*</span> x <span class="sc">*</span> <span class="fu">exp</span>((<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> u<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Z ~ N(0, 1) is symmetric about 0</span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (x <span class="sc">&gt;=</span> <span class="dv">0</span>) {</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.5</span> <span class="sc">+</span> <span class="fu">theta</span>(x, u)</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.5</span> <span class="sc">-</span> <span class="fu">theta</span>(<span class="sc">-</span>x, u)</span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a><span class="co"># for theta_2</span></span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a>z_cdf2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">sigma =</span> <span class="dv">1</span>) {</span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mu, sigma)</span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> X <span class="sc">&lt;=</span> x</span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(i)</span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a><span class="co"># wrap the 2 functions, and collect results</span></span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x =</span> <span class="fl">1.96</span>, <span class="at">n =</span> <span class="dv">100</span>) {</span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a>  t1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a>  t2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a>    t1[i] <span class="ot">&lt;-</span> <span class="fu">z_cdf</span>(x)</span>
<span id="cb91-38"><a href="#cb91-38" aria-hidden="true" tabindex="-1"></a>    t2[i] <span class="ot">&lt;-</span> <span class="fu">z_cdf2</span>(x)</span>
<span id="cb91-39"><a href="#cb91-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-40"><a href="#cb91-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">theta1 =</span> <span class="fu">var</span>(t1), <span class="at">theta2 =</span> <span class="fu">var</span>(t2))</span>
<span id="cb91-41"><a href="#cb91-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-42"><a href="#cb91-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-43"><a href="#cb91-43" aria-hidden="true" tabindex="-1"></a><span class="fu">comparison</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      theta1       theta2 
3.999127e-05 2.826263e-05 </code></pre>
</div>
</div>
<ul>
<li>According to Dr.&nbsp;Ko, three flavors of journals in statistics:
<ul>
<li>theoretical journals</li>
<li>simulation-based journals</li>
<li>applied journals?</li>
</ul></li>
</ul>
</section>
</section>
<section id="section-15" class="level1">
<h1>3/7/2023</h1>
<section id="summary-12" class="level2">
<h2 class="anchored" data-anchor-id="summary-12">Summary</h2>
<p>Variance reduction methods, the Antithetic Variable Method</p>
</section>
<section id="notes-12" class="level2">
<h2 class="anchored" data-anchor-id="notes-12">Notes</h2>
<p>Suppose our goal is to estimate a parameter <span class="math inline">\(\theta\)</span>. Could be population mean, median, variance, etc.</p>
<p><em>Point Estimation:</em> use sample data to calculate a single estimate <span class="math inline">\(\hat{\theta}\)</span> of the population value.</p>
<p>If you have competing estimators, we would choose the one that satisfies the following two criteria:</p>
<ol type="1">
<li><span class="math inline">\(E(\hat{\theta}) = \theta\)</span>; unbiasedness</li>
<li>Minimum variance</li>
</ol>
<p>This is called a Uniformly Minimum Variance Estimate among Unbiased Estimates: UMVUE.</p>
<p>We can apply Monte-Carlo integration to competing estimators to determine which among them have the lowest variance. We demonstrated this in the last class with the Normal CDF.</p>
<section id="antithetic-variable-method" class="level3">
<h3 class="anchored" data-anchor-id="antithetic-variable-method">Antithetic Variable Method</h3>
<p>Suppose we have two random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. Then, <span class="math inline">\(Var(aX \pm bY) = a^2 \cdot Var(X) + b^2 \cdot Var(Y) \pm 2 \cdot a \cdot b \cdot Cov(X, Y)\)</span> where <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are numbers, and <span class="math inline">\(Cov(X, Y) = E(XY) - E(X) \cdot E(Y)\)</span>.</p>
<p>Ex. <span class="math inline">\(Var(2X + 0.5Y)\)</span></p>
<p>We have shown that <span class="math display">\[
\frac{1}{m}\sum_{i=1}^n g(u_i) \to \theta = \int_a^b g(x)\ dx
\]</span></p>
<p>by the law of large numbers.</p>
<p>Now, let <span class="math inline">\(a = b = \frac{1}{2}\)</span>, and thus <span class="math display">\[
Var(\frac{X + Y}{2}) = Var(\frac{1}{2}X + \frac{1}{2}Y) = (\frac{1}{2})^2Var(X) + (\frac{1}{2})^2Var(Y) + 2 \cdot \frac{1}{2} \cdot \frac{1}{2} \cdot Cov(X, Y)
\]</span></p>
<p>Then, let <span class="math inline">\(u_1, u_2 \sim U(0, 1)\)</span> and consider a function <span class="math inline">\(h(\cdot).\)</span></p>
<ol type="a">
<li>if <span class="math inline">\(u_1 \perp u_2\)</span>, then <span class="math inline">\(h(u_1) \perp h(u_2)\)</span> and <span class="math display">\[
Var\Bigl(\frac{h(u_1) + h(u_2)}{2} \Bigr) = \frac{1}{4}(Var(h(u_1)) + Var(h(u_2)))
\]</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> u</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cov(u, v) &lt; 0!</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(u, v)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.08566134</code></pre>
</div>
</div>
<p>Comparison between simple monte-carlo and antithetic variable approach.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>norm_cdf_anti <span class="ot">&lt;-</span> <span class="cf">function</span>(x, n) {</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> u</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">c</span>(u, v)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  pos_cdf <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)) <span class="sc">*</span> <span class="fu">abs</span>(x) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> y<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fl">0.5</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (x <span class="sc">&gt;=</span> <span class="dv">0</span>) {</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>    cdf <span class="ot">&lt;-</span> pos_cdf</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>    cdf <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> pos_cdf</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(cdf))</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>norm_cdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x, n) {</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>  pos_cdf <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)) <span class="sc">*</span> <span class="fu">abs</span>(x) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="fl">0.5</span></span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (x <span class="sc">&gt;=</span> <span class="dv">0</span>) {</span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>    cdf <span class="ot">&lt;-</span> pos_cdf</span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a>    cdf <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> pos_cdf</span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(cdf))</span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb95-33"><a href="#cb95-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-34"><a href="#cb95-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb95-35"><a href="#cb95-35" aria-hidden="true" tabindex="-1"></a>  s[i] <span class="ot">&lt;-</span> <span class="fu">norm_cdf</span>(<span class="fl">1.96</span>, <span class="dv">100</span>)</span>
<span id="cb95-36"><a href="#cb95-36" aria-hidden="true" tabindex="-1"></a>  a[i] <span class="ot">&lt;-</span> <span class="fu">norm_cdf_anti</span>(<span class="fl">1.96</span>, <span class="dv">100</span>)</span>
<span id="cb95-37"><a href="#cb95-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb95-38"><a href="#cb95-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-39"><a href="#cb95-39" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0005521252</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.982865e-06</code></pre>
</div>
</div>
</section>
<section id="control-variate-method" class="level3">
<h3 class="anchored" data-anchor-id="control-variate-method">Control Variate Method</h3>
<p>Let <span class="math inline">\(\theta = E(g(X))\)</span>. An estimate of <span class="math inline">\(\theta\)</span> by control variate method <span class="math inline">\(\hat{\theta}_c\)</span> can be obtained by</p>
<ol type="a">
<li><p>finding a function <span class="math inline">\(l(x)\)</span> of a random variable such that (i) <span class="math inline">\(\mu = E(l(x))\)</span> is known and (ii) <span class="math inline">\(l(x)\)</span> is correlated with <span class="math inline">\(g(x)\)</span> and</p></li>
<li><p>setting <span class="math inline">\(\hat{\theta}_c = g(x) + c[l(x) - \mu]\)</span>.</p></li>
</ol>
<p>Note that the random variable <span class="math inline">\(l(x)\)</span> is called a <em>control variate</em> and does not need to be a pdf. It is just a function of <span class="math inline">\(x\)</span>.</p>
<p>So, how do we find <span class="math inline">\(c\)</span>?</p>
<p><span class="math display">\[
\min_c Var(\hat{\theta}_c) = \min_c Var(1 \cdot g(x) + c \cdot [l(x) - \mu])
\]</span></p>
</section>
</section>
</section>
<section id="section-16" class="level1 page-columns page-full">
<h1>3/9/2023</h1>
<section id="summary-13" class="level2">
<h2 class="anchored" data-anchor-id="summary-13">Summary</h2>
<p>More on the control variate method.</p>
</section>
<section id="notes-13" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="notes-13">Notes</h2>
<ul>
<li>Homework 3 is due on 3/16 (next Thursday)</li>
</ul>
<p><strong>Question from last class:</strong> why are we able to use the SLLN with the antithetic variable method? Aren’t we violating the assumption of i.i.d. draws used for estimation?</p>
<p>Standard Monte Carlo:</p>
<ol type="1">
<li><p><span class="math inline">\(u_1, u_2, u_3, u_4 \sim U(0, 1)\)</span></p></li>
<li><p><span class="math inline">\(\hat{\theta}_4 = \frac{1}{4} \sum_{i = 1}^4 g(u_i)\)</span></p></li>
</ol>
<p>Antithetic Variable Method:</p>
<ol type="1">
<li><span class="math inline">\(u_1, u_2 \sim U(0, 1); u_3 = 1 - u_1, u_4 = 1 - u_2.\)</span>
<ul>
<li>Note that <span class="math inline">\(Cov(u_1, u_3) &lt; 0\)</span> and <span class="math inline">\(Cov(u_2, u_4) &lt; 0.\)</span></li>
</ul></li>
<li>We then estimate a new sample mean</li>
</ol>
<p><span class="math display">\[\begin{align*}
  \theta \leftarrow \frac{1}{4} \sum_{i = 1}^4 g(u_i) &amp;= \frac{g(u_1) + g(u_2) + g(u_3) + g(u_4)}{4} \\
  &amp;= \frac{g(u_1) + g(1 - u_1) + g(u_2) + g(1 - u_2)}{4} \\ \\
  &amp;= \frac{\frac{g(u_1) + g(1 - u_2)}{2} + \frac{g(u_2) + g(1 - u_2)}{2}}{2} \\
  &amp;= \frac{1}{2} \sum_{i = 1}^2 g^*(u_i).
\end{align*}\]</span></p>
<p>So, you end up with half the number of realizations, but <span class="math inline">\(\frac{g(u_1) + g(1 - u_2)}{2}\)</span> and <span class="math inline">\(\frac{g(u_2) + g(1 - u_2)}{2}\)</span> are independent from each other. So, for estimation, they constitute independent and identical draws, and thus we can rely on the SLLN to know that our estimate of <span class="math inline">\(\theta\)</span> converges to the true value as the number of realizations used increases.</p>
<section id="control-variate-method-1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="control-variate-method-1">Control Variate Method</h3>
<p>Picking up where we left off.</p>
<p><span class="math display">\[
\min_c Var(\hat{\theta}_c) = \min_c Var(1 \cdot g(x) + c \cdot [l(x) - \mu])
\]</span></p>
<p>We assume <span class="math inline">\(\mu\)</span>, the mean of <span class="math inline">\(l(x)\)</span> is known. In practice, we can estimate it empirically from simulated data?</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Note that <span class="math inline">\(Var(X + a) = Var(X)\)</span></p>
</div></div><p><span class="math display">\[\begin{align*}
  \min_c Var(\hat{\theta}_c) &amp;= \min_c Var(1 \cdot g(x) + c \cdot [l(x) - \mu]) \\
  &amp;\implies \min_c 1 \cdot Var(g(x)) + c^2 \cdot Var[l(x) - \mu] + 2 \cdot 1 \cdot c \cdot Cov(g(x), l(x)) \\
  &amp;\implies \min_c Var(l(x) - \mu) \cdot c^2  + 2 \cdot Cov(g(x), l(x)) \cdot c + Var(g(x)) \\
  &amp;\implies \frac{d}{dc} \Biggl[ Var(l(x) - \mu) \cdot c^2  + 2 \cdot Cov(g(x), l(x)) \cdot c + Var(g(x)) \Biggr] \equiv 0 \\
  &amp;\implies 2 \cdot Var(l(x) - \mu) \cdot c^* + 2 \cdot Cov(g(x), l(x)) \equiv 0 \\
  &amp;\implies c^* = -\frac{Cov(g(x), l(x))}{Var(l(x))}
\end{align*}\]</span></p>
<p>Is <span class="math inline">\(c^*\)</span> the minimum? Yes: <span class="math display">\[
\frac{d^2}{dc^2} Var(\hat{\theta}_c) \Big|_{c = c^*} &gt; 0.
\]</span></p>
<p>Variance is always positive by definition, so we know that the value found for <span class="math inline">\(c^*\)</span> is the minimum.</p>
<p><span class="math display">\[
c^* = -\frac{Cov(g(x), l(x))}{Var(l(x))}
\]</span></p>
<p><strong>Example:</strong></p>
<p><span class="math display">\[
\theta = E(e^u) = \int_0^1 e^u\ du
\]</span></p>
<p>So <span class="math inline">\(g(u) = e^u.\)</span> First, we need a candidate for <span class="math inline">\(l(x)\)</span>.</p>
<p>How about <span class="math inline">\(l(u) = u\)</span> where <span class="math inline">\(u \sim U(0, 1).\)</span> So, <span class="math inline">\(E(U) = 0.5\)</span> and <span class="math inline">\(Var(U) = \frac{1}{12}\)</span>.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>We solved for these values in Homework 1.</p>
</div></div><p>Then <span class="math display">\[
\hat{\theta}_c = e^u + c \cdot [u - \frac{1}{2}]
\]</span> where <span class="math display">\[
  c = -\frac{Cov(e^u, u)}{Var(u)} = -0.1409 / (1/12).
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cov</span>(<span class="fu">exp</span>(u), u) <span class="sc">/</span> <span class="fu">var</span>(u)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>C</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.707418</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">0.1409</span> <span class="sc">/</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.6908</code></pre>
</div>
</div>
<p><strong>Trying on our own:</strong></p>
<p>Estimate <span class="math inline">\(\theta = \int_0^1 e^{-x} / (1 + x^2)\ dx\)</span> using the control variate method with <span class="math inline">\(l(x) = e^{-0.5} / (1 + x^2)\)</span> and an emperical value of <span class="math inline">\(c^*\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="co"># estimating C</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">10000</span>)</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cov</span>(<span class="fu">g</span>(u), <span class="fu">l</span>(u)) <span class="sc">/</span> <span class="fu">var</span>(<span class="fu">l</span>(u))</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="co"># simple monte-carlo vs. control variate</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>smc <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(u))</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(u) <span class="sc">+</span> C <span class="sc">*</span> (<span class="fu">l</span>(u) <span class="sc">-</span> <span class="fu">mean</span>(<span class="fu">l</span>(u))))</span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(g, <span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.5247971 with absolute error &lt; 5.8e-15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(smc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.538403</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(hat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.538403</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">var</span>(<span class="fu">g</span>(u)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05989671</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">var</span>(<span class="fu">g</span>(u) <span class="sc">+</span> C <span class="sc">*</span> (<span class="fu">l</span>(u) <span class="sc">-</span> <span class="fu">mean</span>(<span class="fu">l</span>(u)))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002997046</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="section-17" class="level1 page-columns page-full">
<h1>3/14/23</h1>
<section id="summary-14" class="level2">
<h2 class="anchored" data-anchor-id="summary-14">Summary</h2>
<p>Importance sampling. Should refer to Dr.&nbsp;Ko’s notes and finish this section.</p>
</section>
<section id="notes-14" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="notes-14">Notes</h2>
<p>See example 6.7.</p>
<p>Let <span class="math inline">\(x_1, x_2, \cdots, x_n \sim (\mu, \sigma^2)\)</span></p>
<p><span class="math display">\[
Var(\bar{X}) = Var(\frac{1}{n} \sum_{i = 1}^n x_i) = Var(\frac{1}{n}x_1 + \frac{1}{n}x_2 + \cdots + \frac{1}{n}x_n) =
\]</span></p>
<p>Better to use <span class="math inline">\(Var(g(x_i)) / n\)</span>? rather than <span class="math inline">\(Var(\hat{\theta}_1, \hat{\theta}_2, \cdots, \hat{\theta}_m).\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="co"># u1, u2, ..., u10k --&gt; e^u1, e^u2, ... e^u10k</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>hat_theta <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">exp</span>(u))</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>est_var <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">exp</span>(u))</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>hat_theta <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">10000</span>)</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>  hat_theta[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">exp</span>(u))</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(hat_theta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.413377e-05</code></pre>
</div>
</div>

<div class="no-row-height column-margin column-container"><div class="">
<p>Dr.&nbsp;Ko: once you’ve taken MATH-462, you should be able to study new topics in statistics on your own.</p>
</div></div><section id="importance-sampling" class="level3">
<h3 class="anchored" data-anchor-id="importance-sampling">Importance Sampling</h3>
<p><span class="math display">\[
\theta = \int_0^1 g(x)\ dx
\]</span></p>
<p><strong>Simple Monte-Carlo</strong></p>
<ol type="1">
<li>Generate <span class="math inline">\(u_1, u_2, ..., u_n \sim U(0, 1)\)</span></li>
<li><span class="math inline">\(\hat{\theta} = \frac{1}{n} \sum_{i=1}^n g(u_i)\)</span></li>
</ol>
<p><strong>Importance sampling</strong></p>
<ol type="1">
<li>Generate <span class="math inline">\(x_1, x_2, ..., x_n \sim f_X(x)\)</span></li>
<li><span class="math inline">\(\hat{\theta} \leftarrow \frac{1}{n} \sum_{i = 1}^n (g(xi) / f(xi))\)</span></li>
</ol>
<p>Here, <span class="math inline">\(f(x)\)</span> is known as an <em>importance</em> function; it is a PDF. We need it to be easy to generate numbers from the importance function. Note a key assumption: <span class="math inline">\(f(x) &gt; 0\)</span> wherever <span class="math inline">\(g(x) &gt; 0\)</span>. That is, support of <span class="math inline">\(f(x)\)</span> is not necessarily the same as that of <span class="math inline">\(g(x)\)</span>.</p>
<p>Let <span class="math inline">\(\theta = \int g(x)dx\)</span> and <span class="math inline">\(X\)</span> be a random variable with pdf <span class="math inline">\(f(x)\)</span> such that <span class="math inline">\(f(x) &gt; 0\)</span> on the set <span class="math inline">\(\{x: g(x) &gt; 0 \}\)</span>.</p>
<p>…</p>
<p>How to pick <span class="math inline">\(f(X)\)</span>?</p>
<ul>
<li>$Var(_I) =<br>
</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 6.11</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, g, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>))</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, f3, <span class="at">lty =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-notes_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="section-18" class="level1 page-columns page-full">
<h1>3/17/23</h1>
<section id="summary-15" class="level2">
<h2 class="anchored" data-anchor-id="summary-15">Summary</h2>
<p>Ch.7, Monte Carlo methods in Statistical Inference</p>
</section>
<section id="notes-15" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="notes-15">Notes</h2>
<ul>
<li>We’re going to cover the topic that has motivated our learning of the preceding topics.</li>
<li>Monte-Carlo methods involve use/generation of random numbers.
<ul>
<li>first we learned how to <em>generate</em> random numbers</li>
<li>then we learned how to use random numbers to perform <em>integration</em>
<ul>
<li><span class="math inline">\(\theta = E[g(x)]\)</span></li>
<li><span class="math inline">\(E(X) = \int_{-\infty}^{\infty} x * f_X(x)\ dx \to \hat{\theta} = \frac{1}{n} \sum_{i = 1}^n x_i \to \theta\)</span></li>
</ul></li>
</ul></li>
</ul>
<section id="mean-square-error-mse" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="mean-square-error-mse">Mean Square Error (MSE)</h3>
<p>Suppose <span class="math inline">\(\hat{\theta}\)</span> is an estimate of <span class="math inline">\(\theta\)</span>. Define <strong>Mean Square Error</strong> of <span class="math inline">\(\hat{\theta}\)</span> as <span class="math display">\[\begin{align*}
  MSE[\hat{\theta}] &amp;= E[(\hat{\theta} - \theta)^2] \\
    &amp;= E[\hat{\theta}^2 - 2 \cdot \theta \cdot \hat{\theta} + \theta^2] \\
    &amp;= E[\hat{\theta}^2] - 2 \theta E[\hat{\theta}] + \theta^2 \\
    &amp;= E[\hat{\theta}^2] - E[\hat{\theta}]^2 + E[\hat{\theta}]^2 - 2 \theta E[\hat{\theta}] + \theta^2 \\
    &amp;= Var(\hat{\theta}) + (E[\hat{\theta}] - \theta)^2
\end{align*}\]</span></p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Note that <span class="math inline">\(\hat{\theta}\)</span> is an estimate, and <span class="math inline">\(\theta\)</span> is the <em>true</em> value of a parameter.</p>
</div><div class="">
<p>MSE can be decomposed into two components. The second term, <span class="math inline">\((E[\hat{\theta}] - \theta)^2\)</span>, can be thought of as a penalty for the <em>bias</em> of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div></div>
<p>Some examples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>  Y[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>(hat_theta <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y))  <span class="co"># should be close to 3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.630376</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>(hat_mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((Y <span class="sc">-</span> <span class="dv">3</span>)<span class="sc">^</span><span class="dv">2</span>))  <span class="co"># should be close to 6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.312739</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 7.1</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>  L[i] <span class="ot">&lt;-</span> <span class="fu">abs</span>(x[<span class="dv">1</span>] <span class="sc">-</span> x[<span class="dv">2</span>])</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>(hat_theta <span class="ot">&lt;-</span> <span class="fu">mean</span>(L))  <span class="co"># should be close to 2 / sqrt(pi)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.08149</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>(hat_mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((L <span class="sc">-</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(pi))<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5757737</code></pre>
</div>
</div>
<p>Kth-level trimmed mean. <span class="math display">\[
\bar{X}_{[-k]} = \frac{1}{n - 2 \cdot k} = \sum_{i = k + 1}^{n - k} x_{(i)}
\]</span></p>
<ul>
<li>Removes the top/bottom <span class="math inline">\(k\)</span> values from a sample and estimates the mean.
<ul>
<li>Used to eliminate extreme values.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example 7.2</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sort</span>(x)</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>  K[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x[k<span class="sc">:</span>(<span class="fu">length</span>(x) <span class="sc">-</span> k)])</span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>(hat_theta <span class="ot">&lt;-</span> <span class="fu">mean</span>(K))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.006158516</code></pre>
</div>
</div>
<p>Next topics: hypothesis testing, confidence intervals.</p>
</section>
</section>
</section>
<section id="section-19" class="level1">
<h1>3/28/23</h1>
<section id="summary-16" class="level2">
<h2 class="anchored" data-anchor-id="summary-16">Summary</h2>
<p>Simulating confidence intervals for a mean.</p>
</section>
<section id="notes-16" class="level2">
<h2 class="anchored" data-anchor-id="notes-16">Notes</h2>
<ul>
<li>Exam 2 this coming Thursday (3/30)
<ul>
<li>topics in chapter 6 (those covered in class)</li>
<li>1 day take-home exam, due 1:30pm 3/31</li>
<li>submitted via email (pdf file) to kyungdukko at boisestate.edu</li>
<li>4 to 6 big questions</li>
<li>Ch. 6 Simple Monte Carlo Integration
<ul>
<li>Variance Reduction Techniques
<ul>
<li>Antithetic</li>
<li>Control Variate</li>
<li>Importance Sampling</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p>Shifting to discuss topics from Chapter 7: Monte-Carlo Methods for Statistical Inference. Last class, we compared mean-square errors for different methods. Now we’ll talk about inference, “something you’ll use the most in your statistical research”.</p>
<p>Inference consists of two areas:</p>
<ul>
<li>Estimation
<ul>
<li>Estimation of unknown parameters <span class="math inline">\(\theta\)</span>
<ul>
<li><em>point</em> estimation: calculate <strong>one number</strong> from a random sample of size <span class="math inline">\(n\)</span>, <span class="math inline">\(x_1, x_2, \dots, x_n\)</span>.
<ul>
<li>typical approach: maximum likelihood estimation</li>
</ul></li>
<li><em>interval</em> estimation: <span class="math inline">\(100 \cdot (1 - \alpha)\)</span>% confidence interval of <span class="math inline">\(\theta\)</span>.
<ul>
<li>Calculate <span class="math inline">\((L, U)\)</span>, the bounds, for unknown <span class="math inline">\(\theta\)</span>.</li>
<li>Expect <span class="math inline">\(\theta\)</span> to be included in the interval <span class="math inline">\((L, U)\)</span> with confidence of <span class="math inline">\(100 \cdot (1 - \alpha)\)</span>%.</li>
</ul></li>
</ul></li>
<li>We’ve already covered point estimation.</li>
</ul></li>
<li>Test of Hypothesis</li>
</ul>
<p>Today, we’ll focus on interval estimation. Elementary statistics give us some formulas for interval estimation. Estimating intervals for and unknown population mean <span class="math inline">\(\mu\)</span> and population variance <span class="math inline">\(\sigma^2\)</span>.</p>
<p>Procedure:</p>
<ol type="1">
<li><p>We need a sample of size <span class="math inline">\(n\)</span>, <span class="math inline">\(x_1, x_2, \dots, x_n\)</span></p></li>
<li><p>We specify our confidence level, choosing a value for <span class="math inline">\(\alpha\)</span> in <span class="math inline">\(100 \cdot (1 - \alpha)\)</span>.</p>
<ul>
<li>Dr.&nbsp;Ko says it’s most common for 90%, 95%, or 99% CIs to be generated.</li>
</ul></li>
<li><p>One of the following conditions:</p>
<ul>
<li><ol type="I">
<li><span class="math inline">\(x_1, x_2, \dots, x_n \sim N(\mu, \sigma^2)\)</span></li>
</ol>
<ul>
<li><span class="math inline">\(\mu\)</span> is unknown, <span class="math inline">\(\sigma^2\)</span> is known, <span class="math inline">\(n \geq 2\)</span></li>
</ul></li>
<li><ol start="2" type="I">
<li><span class="math inline">\(x_1, x_2, \dots, x_n \sim N(\mu, \sigma^2)\)</span></li>
</ol>
<ul>
<li><span class="math inline">\(\mu\)</span> is unknown, <span class="math inline">\(\sigma^2\)</span> is unknown, <span class="math inline">\(n &lt; 30\)</span></li>
</ul></li>
<li><ol start="3" type="I">
<li><span class="math inline">\(x_1, x_2, \dots, x_n \sim (\mu, \sigma^2)\)</span></li>
</ol>
<ul>
<li><span class="math inline">\(\mu\)</span> is unknown, <span class="math inline">\(\sigma^2\)</span> is unknown, <span class="math inline">\(n &gt; 30\)</span></li>
</ul></li>
</ul></li>
</ol>
<p>Formula for I: <span class="math inline">\((\bar{X} - Z_{\frac{\alpha}{2}} \cdot \frac{\sigma}{\sqrt{n}}, \bar{X} + Z_{\frac{\alpha}{2}} \cdot \frac{\sigma}{\sqrt{n}})\)</span>, where <span class="math inline">\(\bar{X} = \sum_{i = 1}^n x_i / n\)</span>.</p>
<p>Formula for II: <span class="math inline">\((\bar{X} - T_{\frac{\alpha}{2}, df = n-1} \cdot \frac{s}{\sqrt{n}}, \bar{X} + T_{\frac{\alpha}{2}, df = n-1} \cdot \frac{s}{\sqrt{n}})\)</span>, where <span class="math inline">\(\bar{X} = \sum_{i = 1}^n x_i / n\)</span>.</p>
<p>Formula for III: <span class="math inline">\((\bar{X} - Z_{\frac{\alpha}{2}} \cdot \frac{s}{\sqrt{n}}, \bar{X} + Z_{\frac{\alpha}{2}} \cdot \frac{s}{\sqrt{n}})\)</span>, where <span class="math inline">\(\bar{X} = \sum_{i = 1}^n x_i / n\)</span>. - By the Central Limit Theorem, <span class="math inline">\(\bar{X} \overset{approx}{\sim} N(\mu, \frac{\sigma}{\sqrt{n}}^2)\)</span></p>
<p>Examples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">580</span>, <span class="dv">400</span>, <span class="dv">428</span>, <span class="dv">825</span>, <span class="dv">850</span>, <span class="dv">875</span>, <span class="dv">920</span>, <span class="dv">550</span>, <span class="dv">575</span>, <span class="dv">750</span>, <span class="dv">636</span>, <span class="dv">360</span>, <span class="dv">590</span>, <span class="dv">735</span>, <span class="dv">950</span>)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.05</span>)</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> a <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>(c90 <span class="ot">&lt;-</span> <span class="fu">c</span>(m <span class="sc">-</span> t[<span class="dv">1</span>] <span class="sc">*</span> s <span class="sc">/</span> <span class="fu">sqrt</span>(n), m <span class="sc">+</span> t[<span class="dv">1</span>] <span class="sc">*</span> s <span class="sc">/</span> <span class="fu">sqrt</span>(n)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 580.9106 755.6227</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>(c95 <span class="ot">&lt;-</span> <span class="fu">c</span>(m <span class="sc">-</span> t[<span class="dv">2</span>] <span class="sc">*</span> s <span class="sc">/</span> <span class="fu">sqrt</span>(n), m <span class="sc">+</span> t[<span class="dv">2</span>] <span class="sc">*</span> s <span class="sc">/</span> <span class="fu">sqrt</span>(n)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 561.8913 774.6420</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">65</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fl">2.4</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> <span class="dv">3</span>)</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>(c95 <span class="ot">&lt;-</span> <span class="fu">c</span>(m <span class="sc">-</span> t <span class="sc">*</span> s <span class="sc">/</span> <span class="fu">sqrt</span>(n), m <span class="sc">+</span> t <span class="sc">*</span> s <span class="sc">/</span> <span class="fu">sqrt</span>(n)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 61.18106 68.81894</code></pre>
</div>
</div>
<p>How do we know if a method for estimating a CI is valid? We have to prove that that the estimator meets the property (<span class="math inline">\(\theta\)</span> contained within the interval, at probability <span class="math inline">\(1 - \alpha\)</span>).</p>
<p>Empirical confidence level, for the t-statistic interval estimation. Let <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> be fixed. Draw a random sample of size <span class="math inline">\(n\)</span> from the normal distribution with paramters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>, and compute a 95% CI interval from the sample. Repeat this <span class="math inline">\(k\)</span> times, and then compute the proportion of estimated intervals that contain <span class="math inline">\(\mu\)</span>.</p>
<p><span class="math display">\[\begin{align*}
  (L, U)_1 &amp;\leftarrow x^1_1, x^1_2, \dots, x^1_n \sim N(\mu, \sigma) \\
  (L, U)_2 &amp;\leftarrow x^2_1, x^2_2, \dots, x^2_n \sim N(\mu, \sigma) \\
  &amp;\vdots \\
  (L, U)_k &amp;\leftarrow x^k_1, x^k_2, \dots, x^k_n \sim N(\mu, \sigma)
\end{align*}\]</span></p>
<p>In R, this can be accomplished, using <span class="math inline">\(k = 1000\)</span>, <span class="math inline">\(n = 20\)</span>, <span class="math inline">\(\mu = 15\)</span>, <span class="math inline">\(\sigma = 3\)</span>, with an alpha of 0.05.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>t_ci <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mu =</span> <span class="dv">15</span>, <span class="at">sigma =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) {</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mu, sigma)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>  m <span class="sc">+</span> (t <span class="sc">*</span> s <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">*</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">expr =</span> <span class="fu">t_ci</span>(), <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>(chk <span class="ot">&lt;-</span> res <span class="sc">|&gt;</span> <span class="fu">map_lgl</span>(<span class="sc">~</span><span class="fu">between</span>(<span class="dv">15</span>, .[<span class="dv">1</span>], .[<span class="dv">2</span>])) <span class="sc">|&gt;</span> <span class="fu">mean</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.96</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>res <span class="sc">|&gt;</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_df</span>(enframe, <span class="at">.id =</span> <span class="st">"m"</span>) <span class="sc">|&gt;</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">m =</span> <span class="fu">as.numeric</span>(m)) <span class="sc">|&gt;</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> name, <span class="at">values_from =</span> value) <span class="sc">|&gt;</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">"m"</span>, <span class="st">"l"</span>, <span class="st">"u"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(m) <span class="sc">|&gt;</span></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contains_truth =</span> <span class="fu">between</span>(<span class="dv">15</span>, l, u)) <span class="sc">|&gt;</span></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> m, <span class="at">ymin =</span> l, <span class="at">ymax =</span> u, <span class="at">color =</span> contains_truth)) <span class="sc">+</span></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>() <span class="sc">+</span></span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">15</span>, <span class="at">lty =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkblue"</span>, <span class="st">"skyblue"</span>)) <span class="sc">+</span></span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">8</span>, <span class="dv">22</span>) <span class="sc">+</span></span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-notes_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="section-20" class="level1">
<h1>4/4/23</h1>
<section id="summary-17" class="level2">
<h2 class="anchored" data-anchor-id="summary-17">Summary</h2>
<p>Confidence interval for variance, hypothesis testing.</p>
</section>
<section id="notes-17" class="level2">
<h2 class="anchored" data-anchor-id="notes-17">Notes</h2>
<p>We’ll get back our exam results via email on Thursday.</p>
<p><strong>Today:</strong> simulations of confidence intervals. Suppose we have a random sample <span class="math display">\[
X_1, X_2, \cdots, X_n \sim N(\mu, \sigma^2)
\]</span></p>
<p>where: <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> are unknown, and <span class="math inline">\(n &lt; 30\)</span>.</p>
<p>Our formula, based on this scenario, for a <span class="math inline">\(100 \cdot (1 - \alpha)%\)</span> CI of <span class="math inline">\(\mu\)</span>: <span class="math display">\[
(\bar{X} - t_{\frac{\alpha}{2}, n - 1} \cdot \frac{s}{\sqrt{n}}, \bar{X} + t_{\frac{\alpha}{2}, n - 1} \cdot \frac{s}{\sqrt{n}})
\]</span></p>
<p>Last time, we checked to see (empirically) if the interval formula worked as intended.</p>
<p>Now, again with a random sample from a normal distribution, let’s check a one-sided confidence interval for unknown <span class="math inline">\(\sigma^2\)</span>, with proposed formula <span class="math display">\[
\Big(0, \frac{(n - 1) \cdot s^2}{\chi^2_{\alpha, n - 1}} \Big), s^2 = \frac{\sum_{i = 1}^n (x_i - \bar{x})^2}{n - 1}.
\]</span></p>
<p>Check if this is valid using <span class="math inline">\(\mu = 0, \sigma^2 = 4, n = 20, m = 10,000\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>s_ci <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">mu =</span> <span class="dv">0</span>, <span class="at">sigma =</span> <span class="dv">2</span>, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) {</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">var</span>(x)</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  chi <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(alpha, n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">0</span>, (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> v <span class="sc">/</span> chi)</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, <span class="fu">s_ci</span>(), <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>(chk <span class="ot">&lt;-</span> res <span class="sc">|&gt;</span> <span class="fu">map_lgl</span>(<span class="sc">~</span><span class="fu">between</span>(<span class="dv">4</span>, .[<span class="dv">1</span>], .[<span class="dv">2</span>])) <span class="sc">|&gt;</span> <span class="fu">mean</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.95</code></pre>
</div>
</div>
<section id="testing-of-hypotheses" class="level3">
<h3 class="anchored" data-anchor-id="testing-of-hypotheses">Testing of Hypotheses</h3>
<p>Given: a claim about a parameter <span class="math inline">\(\theta\)</span>:</p>
<ol type="1">
<li><p>Choose a significance level (<span class="math inline">\(\alpha\)</span>), typically 0.01, 0.05, or 0.10.</p></li>
<li><p>Set up statistical hypotheses based on the given claim</p>
<ul>
<li><span class="math inline">\(H_1\)</span> or <span class="math inline">\(H_a\)</span>, the <em>alternative</em> hypothesis</li>
<li><span class="math inline">\(H_0\)</span>, the <em>null</em> hypothesis</li>
<li>Note: <span class="math inline">\(H_0 \cap H_1 = \{\}\)</span> (they must be mutually exclusive)</li>
<li>Conventions: the claim is typically set as <span class="math inline">\(H_1\)</span>, <strong><em>but</em></strong> equality should be on <span class="math inline">\(H_0\)</span>.</li>
</ul></li>
</ol>
<p><strong>Example 1.</strong> The average annual income of workers who majored in mathematics is greater than 100,000. Let <span class="math inline">\(\mu\)</span> = the average annual income. Then, <span class="math inline">\(H_1: \mu &gt; 100000\)</span>, and <span class="math inline">\(H_0: \mu \leq 100000\)</span>.</p>
<p><strong>Example 2.</strong> The average amount of rubbing alcohol in containers is at least 12 oz. Let <span class="math inline">\(\mu = 12\)</span>. Then, <span class="math inline">\(H_1: \mu &lt; 12\)</span> and <span class="math inline">\(H_0: \mu \geq 12\)</span>.</p>
<p><strong>Example 3.</strong> The average IQ of mathematics students is 130. Let <span class="math inline">\(\mu = 130\)</span>. Then <span class="math inline">\(H_1: \mu \neq 130\)</span> and <span class="math inline">\(H_0: \mu = 130\)</span>.</p>
<ol start="3" type="1">
<li>Calculate the Test Statistic (T.S.) under the assumption that <span class="math inline">\(H_0\)</span> is true.</li>
</ol>
<p>The T.S. value is a function of the sample <span class="math inline">\(x_1, x_2, \cdots, x_n\)</span> and other known information for the population.</p>
<ol start="4" type="1">
<li><p>Find the rejection region of <span class="math inline">\(H_0\)</span> based on the probability distribution of the Test Statistic.</p></li>
<li><p>Decision: if T.S. is in the rejection region, then we reject the null hypothesis <span class="math inline">\(H_0\)</span>.</p></li>
</ol>
<p>Steps 3 and 4 are the theoretical aspects of hypothesis testing. We cover these two in Math 462 / Math 562.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Nature</th>
<th style="text-align: left;">Accept <span class="math inline">\(H_0\)</span></th>
<th style="text-align: left;">Accept <span class="math inline">\(H_1\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(H_0\)</span> is true</td>
<td style="text-align: left;">Correct</td>
<td style="text-align: left;">Type I error</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(H_1\)</span> is true</td>
<td style="text-align: left;">Type II error</td>
<td style="text-align: left;">Correct</td>
</tr>
</tbody>
</table>
<p>Type I error = <span class="math inline">\(P[\text{reject } H_0 | H_0 \text{ is true}] = \alpha\)</span></p>
<p>Type II error = <span class="math inline">\(P[\text{reject } H_1 | H_1 \text{ is true}] = \beta\)</span></p>
<p>Note: <span class="math inline">\(1 - \beta\)</span> is called the <em>power</em> of a test.</p>
<p>Goal: to minimize both types of error. <em>But</em>, it’s not possible to minimize both at the same time. The hypotheses are mutually exclusive. If we minimize one type, the probability of the other will increase.</p>
<p>So, statistical hypothesis testing takes the following form:</p>
<ol type="1">
<li>fix the type I error to a small number (0.01, 0.05, 0.10)</li>
<li>minimize type II error.</li>
</ol>
<p>A test that accomplishes these things is called the Uniformly Most Powerful Test (UMP Test).</p>
</section>
</section>
</section>
<section id="section-21" class="level1">
<h1>4/6/23</h1>
<section id="summary-18" class="level2">
<h2 class="anchored" data-anchor-id="summary-18">Summary</h2>
<p>Computation of test statistics.</p>
</section>
<section id="notes-18" class="level2">
<h2 class="anchored" data-anchor-id="notes-18">Notes</h2>
<p>Review of question 5 from the exam.</p>
<p>We want <span class="math inline">\(\theta = \int_0^1 h(x)\ dx\)</span>, where <span class="math inline">\(h(x) = -0.5x + 0.5\)</span>, using the hit-or-miss method. For this procedure, we generate two uniform variables from <span class="math inline">\(U(0, 1)\)</span>, <span class="math inline">\(u_1\)</span> and <span class="math inline">\(u_2\)</span>.</p>
<p>TODO: typeset this</p>
<pre><code>0 &lt;= h(x) &lt;= b
x = u1
y = b * u2

0 &lt;= h(x) &lt;= -0.5x + 0.5 &lt;= 0.5
x = 0 -&gt; h(0) = 0.5 = b
x = 1 -&gt; h(1) = 0</code></pre>
<p>Final exam will consist of new topics after Exam 2, but also topics from before. It’s cumulative. One question from each exam will be included in the final.</p>
<p>Continuing with hypothesis testing.</p>
<ol start="5" type="1">
<li>Decision making: if T.S. is in the rejection region, then we reject <span class="math inline">\(H_0\)</span>.</li>
</ol>
<p>So, how do we determine the rejection region?</p>
<ul>
<li>tests of equality <span class="math inline">\(H_0: \theta = \theta_0\)</span> vs.&nbsp;<span class="math inline">\(H_1: \theta \neq \theta_0\)</span> are <em>two-sided tests</em> (area of each region is <span class="math inline">\(\alpha / 2\)</span>).</li>
<li>testing claims that a quantity is greater than some value result in rejection regions on the right-tail</li>
<li>testing claims that a quantity is larger than some value result in rejection regions on the left-tail</li>
</ul>
<p><strong>Example.</strong> Test of hypothesis for an unknown population mean <span class="math inline">\(\mu\)</span>. Let <span class="math inline">\(X_1, X_2, \cdots, X_n\)</span> be a random sample.</p>
<p>Scenario I. <span class="math inline">\(\mu\)</span> is unknown, <span class="math inline">\(n \geq 2\)</span> and <span class="math inline">\(\sigma^2\)</span> is known. <span class="math inline">\(X_1, X_2, \cdots, X_n \sim N(\mu, \sigma^2)\)</span>. - Assuming <span class="math inline">\(H_0\)</span> is true: <span class="math inline">\(T.S.^I = \frac{\bar{x} - \mu_0}{\sigma / \sqrt{n}} \sim N(0, 1)\)</span></p>
<p>Scenario II. <span class="math inline">\(\mu\)</span> is unknown, <span class="math inline">\(n &lt; 30\)</span> and <span class="math inline">\(\sigma^2\)</span> is unknown. <span class="math inline">\(X_1, X_2, \cdots, X_n \sim N(\mu, \sigma^2)\)</span>. - Assuming <span class="math inline">\(H_0\)</span> is true: <span class="math inline">\(T.S.^{II} = \frac{\bar{x} - \mu_0}{s / \sqrt{n}} \sim t(df = n - 1)\)</span></p>
<p>Scenario III. <span class="math inline">\(\mu\)</span> is unknown, <span class="math inline">\(n &gt; 30\)</span> and <span class="math inline">\(\sigma^2\)</span> is unknown. <span class="math inline">\(X_1, X_2, \cdots, X_n \sim (\mu, \sigma^2)\)</span>. - Assuming <span class="math inline">\(H_0\)</span> is true: <span class="math inline">\(T.S.^{III} = \frac{\bar{x} - \mu_0}{s / \sqrt{n}} \overset{approx}{\sim} N(0, 1)\)</span></p>
<p><strong>Example.</strong> The heights of young American men, in inches, are normally distributed with unknown mean <span class="math inline">\(\mu\)</span> and unknown standard deviation <span class="math inline">\(\sigma\)</span>. You select a random sample of 4 young American men and measure their heights. The sample mean of the 4 measurements is 65 inches and the sample standard deviation is 2.4 inches.</p>
<p>Someone claims that the mean height of young American men is 70 inches. Construct <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span>.</p>
<p><span class="math inline">\(H_0: \mu = 70\)</span>, <span class="math inline">\(H_1: \mu \neq 70\)</span>. This is scenario II.</p>
<p><span class="math inline">\(T.S.^{II} = \frac{65 - 70}{-2.4 / \sqrt{4}} \approx 4.16\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="dv">65</span> <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.025</span>, <span class="dv">3</span>) <span class="sc">*</span> <span class="fl">2.4</span> <span class="sc">/</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 68.81894</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="dv">65</span> <span class="sc">+</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.025</span>, <span class="dv">3</span>) <span class="sc">*</span> <span class="fl">2.4</span> <span class="sc">/</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 68.81894</code></pre>
</div>
</div>
</section>
</section>
<section id="section-22" class="level1">
<h1>4/11/23</h1>
<section id="summary-19" class="level2">
<h2 class="anchored" data-anchor-id="summary-19">Summary</h2>
<p>Hypothesis testing, most recap from MATH-471.</p>
</section>
<section id="notes-19" class="level2">
<h2 class="anchored" data-anchor-id="notes-19">Notes</h2>
<p><strong>Example.</strong> The heights of young American men, in inches, are normally distributed with unknown mean <span class="math inline">\(\mu\)</span> and unknown standard deviation <span class="math inline">\(\sigma\)</span>. You select a random sample of 4 young American men and measure their heights. The sample mean of the 4 measurements is 65 inches and the sample standard deviation is 2.4 inches.</p>
<p>Someone claims that the mean height of young American men is greater than 70 inches. Construct <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span>.</p>
<p><span class="math inline">\(H_0: \mu \leq 70\)</span>, <span class="math inline">\(H_1: \mu &gt; 70\)</span>. This is scenario II.</p>
<p><span class="math inline">\(T.S.^{II} = \frac{65 - 70}{2.4 / \sqrt{4}} \approx -4.16\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span>, <span class="at">df =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.353363</code></pre>
</div>
</div>
<p>Fail to reject.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculating the p-values</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span>, <span class="dv">3</span>), <span class="dv">3</span>) <span class="co"># == 0.05</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="sc">-</span><span class="fl">4.16</span>, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9873682</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">61</span>, <span class="dv">67</span>, <span class="dv">63</span>, <span class="fl">66.6</span>)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(x, <span class="at">alternative =</span> <span class="st">"greater"</span>, <span class="at">mu =</span> <span class="dv">70</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  x
t = -3.8705, df = 3, p-value = 0.9847
alternative hypothesis: true mean is greater than 70
95 percent confidence interval:
 60.99507      Inf
sample estimates:
mean of x 
     64.4 </code></pre>
</div>
</div>
<p>Other notes taken by hand. Mostly a review from content done in MATH-471 (Data Analysis).</p>
</section>
</section>
<section id="section-23" class="level1">
<h1>4/13/23</h1>
<section id="summary-20" class="level2">
<h2 class="anchored" data-anchor-id="summary-20">Summary</h2>
</section>
<section id="notes-20" class="level2">
<h2 class="anchored" data-anchor-id="notes-20">Notes</h2>
<p>One more example of classical hypothesis testing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>beams <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">580</span>, <span class="dv">400</span>, <span class="dv">428</span>, <span class="dv">825</span>, <span class="dv">850</span>, <span class="dv">875</span>, <span class="dv">920</span>, <span class="dv">550</span>, <span class="dv">575</span>, <span class="dv">750</span>, <span class="dv">636</span>, <span class="dv">360</span>, <span class="dv">590</span>, <span class="dv">735</span>, <span class="dv">950</span>)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(beams, <span class="at">mu =</span> <span class="dv">820</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  beams
t = -3.0593, df = 14, p-value = 0.9958
alternative hypothesis: true mean is greater than 820
95 percent confidence interval:
 580.9106      Inf
sample estimates:
mean of x 
 668.2667 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>bound <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.1</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> <span class="fu">length</span>(beams) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sd</span>(beams) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(beams))</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(beams) <span class="sc">+</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>) <span class="sc">*</span> bound</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 580.9106 755.6227</code></pre>
</div>
</div>
<p>Now, onto computational statistics.</p>
<p>Suppose we have a test statistic <span class="math inline">\(T.S.^*\)</span> that is proposed. The goal is to then assess the proposed statistic to see that it does not exceed a specified <span class="math inline">\(\alpha\)</span>, and that it minimizes <span class="math inline">\(\beta\)</span>.</p>
<p>Procedure:</p>
<ol type="1">
<li>Generate sample values, under the assumption that <span class="math inline">\(H_0\)</span> is true.</li>
</ol>
<p><span class="math display">\[\begin{align*}
  x^1_1, x^1_2, &amp;\cdots, x^1_n \\
  x^2_1, x^2_2, &amp;\cdots, x^2_n \\
  &amp;\vdots \\
  x^k_1, x^k_2, &amp;\cdots, x^k_n
\end{align*}\]</span></p>
<ol start="2" type="1">
<li><p>Generate <span class="math inline">\(T.S.^i\)</span> for each sample <span class="math inline">\(i = 1, 2, \cdots, k\)</span>.</p></li>
<li><p>Compute <span class="math inline">\(I^i = \begin{cases} 1 &amp; T.S.^i \text{ in rejection region} \\ 0 &amp; \text{otherwise} \end{cases}.\)</span></p></li>
<li><p>Compute <span class="math inline">\(\frac{1}{k} \sum_{i = 1}^k I^i\)</span> to determine the empirical <span class="math inline">\(\alpha\)</span>.</p></li>
</ol>
<p><strong>Example.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Steps 1 and 2</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>gen_ts <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">20</span>, <span class="at">mu =</span> <span class="dv">500</span>, <span class="at">sigma2 =</span> <span class="dv">100</span>) {</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">500</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(sigma2))</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">mean</span>(x) <span class="sc">-</span> mu) <span class="sc">/</span> (<span class="fu">sd</span>(x) <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Steps 3 and 4</span></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>check_rr <span class="ot">&lt;-</span> <span class="cf">function</span>(ts, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">alpha =</span> <span class="fl">0.05</span>) {</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>  t_actual <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.05</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(ts <span class="sc">&lt;=</span> t_actual)</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="fu">gen_ts</span>(), <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a><span class="fu">check_rr</span>(<span class="fu">unlist</span>(ts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.058</code></pre>
</div>
</div>
</section>
</section>
<section id="section-24" class="level1">
<h1>4/18/23</h1>
<section id="summary-21" class="level2">
<h2 class="anchored" data-anchor-id="summary-21">Summary</h2>
<p>More hypothesis testing, discussion of bootstrap sampling.</p>
</section>
<section id="notes-21" class="level2">
<h2 class="anchored" data-anchor-id="notes-21">Notes</h2>
<p>Given:</p>
<ul>
<li><span class="math inline">\(X_1, X_2, \cdots, X_{20} \sim N(\mu, \sigma^2)\)</span></li>
</ul>
<ol type="1">
<li>Calculate the <em>empirical significance level</em> (<span class="math inline">\(Pr(\text{reject } H_0 | H_0 \text{ is true})\)</span>) with nominal <span class="math inline">\(\alpha = 0.05\)</span> and <span class="math inline">\(n = 20\)</span>, using <span class="math inline">\(m = 1000\)</span>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">qt</span>(alpha <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">17</span></span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a>tstat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb156-11"><a href="#cb156-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-12"><a href="#cb156-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb156-13"><a href="#cb156-13" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> mu0, <span class="at">sd =</span> <span class="fu">sqrt</span>(sigma2))</span>
<span id="cb156-14"><a href="#cb156-14" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb156-15"><a href="#cb156-15" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb156-16"><a href="#cb156-16" aria-hidden="true" tabindex="-1"></a>  tstat[i] <span class="ot">&lt;-</span> (a <span class="sc">-</span> mu0) <span class="sc">/</span> (s <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span>
<span id="cb156-17"><a href="#cb156-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb156-18"><a href="#cb156-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-19"><a href="#cb156-19" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">between</span>(tstat, Q, <span class="sc">-</span>Q)) <span class="sc">/</span> m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.043</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Calculate the <em>power</em> (<span class="math inline">\(1 - Pr(\text{accept } H_0 | H_1 \text{ is true}))\)</span>), using the same simulation configuration.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>tstat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> mu1, <span class="at">sd =</span> <span class="fu">sqrt</span>(sigma2))</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>  tstat[i] <span class="ot">&lt;-</span> (a <span class="sc">-</span> <span class="dv">15</span>) <span class="sc">/</span> (s <span class="sc">/</span> <span class="fu">sqrt</span>(n))</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">between</span>(tstat, Q, <span class="sc">-</span>Q)) <span class="sc">/</span> m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.986</code></pre>
</div>
</div>
<p>Moving on to Chapter 8: <strong>Resampling Methods</strong>.</p>
<p>Goal of inference: estimate <span class="math inline">\(\theta\)</span> with a point estimate <span class="math inline">\(\hat{\theta}(x_1, x_2, \cdots, x_n)\)</span>.</p>
<ol type="1">
<li>The estimator should be unbiased (<span class="math inline">\(E(\hat{\theta}) = \theta\)</span>)</li>
<li>The proposed estimator should have the smallest standard error <span class="math inline">\(\sqrt{Var(\hat{\theta})}\)</span></li>
</ol>
<p>Rather than using theoretical proofs to prove qualities of a given estimator, we <em>resample</em> from a given <em>sample</em> that we’ve collected, and use empirical estimates(?). We’ll cover the Bootstrap and Jacknife resampling methods.</p>
<p>Resampling treats an observed sample as a finite population, and random samples are generated (or resampled) from the observed sample to estimate population characteristics and make inference about the sampled population.</p>
<p>Bootstrap sampling.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="fl">0.5</span>, <span class="fl">2.6</span>, <span class="fl">5.6</span>)</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="fu">length</span>(x), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="section-25" class="level1">
<h1>4/20/23</h1>
<section id="summary-22" class="level2">
<h2 class="anchored" data-anchor-id="summary-22">Summary</h2>
<p>Absent for travel.</p>
</section>
<section id="notes-22" class="level2">
<h2 class="anchored" data-anchor-id="notes-22">Notes</h2>
<p>N/A</p>
</section>
</section>
<section id="section-26" class="level1 page-columns page-full">
<h1>4/25/23</h1>
<section id="summary-23" class="level2">
<h2 class="anchored" data-anchor-id="summary-23">Summary</h2>
<p>Linear regression, ANOVA.</p>
</section>
<section id="notes-23" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="notes-23">Notes</h2>
<p>Today, continuing discussion of linear regression.</p>
<p>Supose we have a set of bivariate data: <span class="math inline">\((x_1, y_1), (x_2, y_2), \cdots, (x_n, y_n).\)</span> We can graphically assess the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> using a scatterplot. If we observe a <em>linear</em> relationship, its strength and direction can be quantified using Pearson’s <span class="math inline">\(r\)</span>.</p>
<p>Linear relationships can be specified using an equation:</p>
<p><span class="math display">\[\begin{align*}
  y &amp;= f(x) + \epsilon \\
    &amp;= \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_{p - 1} x_{p - 1} + \epsilon.
\end{align*}\]</span></p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Note that a <em>dependent</em> variable <span class="math inline">\(y\)</span> can be modeled using <span class="math inline">\(p\)</span> different predictors.</p>
</div></div><p>We’re attempting to estimate <span class="math inline">\(\hat{\beta}_0, \hat{\beta}_1, \cdots, \hat{\beta}_{p - 1}\)</span>.</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 x_{1,i} + \beta_2 x_{2, i} +  \cdots + \beta_{p - 1} x_{p - 1, i} + \epsilon_i, i = 1, 2, 3, \cdots, n.
\]</span></p>
<p><span class="math display">\[
y = \begin{bmatrix} y_1 \\ y_2 \\ \vdots \\ y_n \end{bmatrix}; X = \begin{bmatrix} 1 &amp; x_{1,1} &amp; x_{1,2} &amp; \cdots &amp; x_{1,p-1} \\ 1 &amp; x_{2,1} &amp; x_{2,2} &amp; \cdots &amp; x_{2,p-1} \\ \vdots &amp; \vdots &amp; \vdots &amp;  &amp; \vdots \\ 1 &amp; x_{n,1} &amp; x_{n, 2} &amp; \cdots &amp; x_{n, p-1} \end{bmatrix}
\]</span></p>
<p>The least-squares estimation procedure for the coefficients is <span class="math inline">\(\hat{\beta} = (X^TX)^{-1}X^TY\)</span>, where <span class="math inline">\(X\)</span> is a matrix of predictor variables (the <em>design</em> matrix), and <span class="math inline">\(Y\)</span> is the dependent variable.</p>
<p>In R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>)</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="dv">3</span>, <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">t</span>(x) <span class="sc">%*%</span> x) <span class="sc">%*%</span> <span class="fu">t</span>(x) <span class="sc">%*%</span> y <span class="co"># (X^T * X)^(-1) * X^T * Y</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,] 0.00
[2,] 0.05</code></pre>
</div>
</div>
<p>Here, <code>solve()</code> is used to take the inverse of a matrix, and <code>%*%</code> is the operator for matrix multiplication.</p>
<p><strong>Example.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">23</span>, <span class="dv">25</span>, <span class="dv">41</span>, <span class="dv">49</span>, <span class="dv">55</span>, <span class="dv">63</span>, <span class="dv">67</span>, <span class="dv">74</span>, <span class="dv">80</span>)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>distance <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">591</span>, <span class="dv">512</span>, <span class="dv">495</span>, <span class="dv">467</span>, <span class="dv">380</span>, <span class="dv">418</span>, <span class="dv">356</span>, <span class="dv">415</span>, <span class="dv">420</span>, <span class="dv">347</span>)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(age, distance)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> distance))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class-notes_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(age, distance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8606378</code></pre>
</div>
</div>
<p>Distance is negatively correlated with age. We want to estimate the following equation:</p>
<p><span class="math inline">\(distance = \beta_0 + \beta_1 \cdot age + \epsilon.\)</span></p>
<p>Using R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(age)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(intercept, age)</span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>betas <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X) <span class="sc">%*%</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> distance</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="co"># compare results with built-in function</span></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>betas</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                [,1]
intercept 589.737035
age        -3.010806</code></pre>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(distance <span class="sc">~</span> age))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         age 
 589.737035   -3.010806 </code></pre>
</div>
</div>
<p>Thus, we have</p>
<p><span class="math inline">\(E[\widehat{distance}] = 589.74 - 3.01 \cdot age + \epsilon\)</span></p>
<p>Then, a person aged 66 would be expected to have a reading distance of</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>betas[<span class="dv">1</span>] <span class="sc">+</span> betas[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">66</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 391.0239</code></pre>
</div>
</div>
<p>feet (on average).</p>
<p><strong>Another example.</strong></p>
<blockquote class="blockquote">
<p>Alex is a family doctor, and has taken a random sample of 14 of his patients, measuring their age, avg. daily consumption of saturated fat, and cholesterol.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">25</span>, <span class="dv">28</span>, <span class="dv">32</span>, <span class="dv">32</span>, <span class="dv">32</span>, <span class="dv">38</span>, <span class="dv">42</span>, <span class="dv">48</span>, <span class="dv">51</span>, <span class="dv">51</span>, <span class="dv">58</span>, <span class="dv">62</span>, <span class="dv">65</span>)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>fat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">28</span>, <span class="dv">19</span>, <span class="dv">16</span>, <span class="dv">24</span>, <span class="dv">20</span>, <span class="dv">31</span>, <span class="dv">20</span>, <span class="dv">26</span>, <span class="dv">24</span>, <span class="dv">32</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">30</span>)</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>chol <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">180</span>, <span class="dv">195</span>, <span class="dv">186</span>, <span class="dv">180</span>, <span class="dv">210</span>, <span class="dv">197</span>, <span class="dv">239</span>, <span class="dv">183</span>, <span class="dv">204</span>, <span class="dv">221</span>, <span class="dv">243</span>, <span class="dv">208</span>, <span class="dv">228</span>, <span class="dv">269</span>)</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>const <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(age)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(const, age, fat)</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>betas <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X) <span class="sc">%*%</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> chol</span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>betas</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
const 90.841516
age    1.014205
fat    3.244265</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(chol <span class="sc">~</span> age <span class="sc">+</span> fat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         age         fat 
  90.841516    1.014205    3.244265 </code></pre>
</div>
</div>
<p>A new patient with age = 22, fat = 20:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>betas[<span class="dv">1</span>] <span class="sc">+</span> betas[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">22</span> <span class="sc">+</span> betas[<span class="dv">3</span>] <span class="sc">*</span> <span class="dv">20</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 178.0393</code></pre>
</div>
</div>
<ul>
<li><span class="math inline">\(H_0: \beta_0 = \beta_1 = \beta_2 = 0\)</span></li>
<li><span class="math inline">\(H_1: H_0 \text{ is not true.}\)</span></li>
</ul>
<p><strong>ANOVA</strong> (Analysis of Variance): the total variation of <span class="math inline">\(y\)</span> can be summarized as SST = SSR + SSE, i.e.,</p>
<p><span class="math display">\[
\underset{\text{SST "Sum of Squares Total"}}{\underbrace{\sum_{i = 1}^n (y_i - \bar{y})^2}} = \underset{\text{SSR "Regression Sum of Squares"}}{\underbrace{\sum_{i = 1}^n (\hat{y_i} - \bar{y})^2}} + \underset{\text{SSE "Sum of Squares Error"}}{\underbrace{\sum_{i = 1}^n (y_i - \hat{y_i})^2}}
\]</span></p>
<ul>
<li>SST: total variation of <span class="math inline">\(y\)</span>
<ul>
<li>SSR: the amount of variation explained by the regression equation</li>
<li>SSE: the amount of variation explained by variables not in the regression equation</li>
</ul></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>