---
title: "MATH-472: Homework 2"
author: "Andrew Moore"
date: "2/9/23"
knitr:
  opts_chunk: 
    echo: true
    warning: false
    message: false
---

# Question 1

<!-- Write an R function to calculate $\Gamma(n)$ for any positive integer $n$. You cannot use the built-in gamma function in R. -->

The definition of the Gamma function where $n \in \mathbb{Z}^{+}$ is
$$
\Gamma(n) = (n - 1)!
$$

This can be replicated in R using the `factorial()` function.

```{r}
posint_gamma <- function(n) {
  if (any(!is.integer(n) | n <= 0)) stop("n must be a positive integer.")
  
  factorial(n - 1)
}

all(posint_gamma(1:4) == gamma(1:4))
```

\newpage
# Question 2

\newpage
# Question 3

Let $X$ be a discrete random variable with the following cdf, and pdf:

|         $X$          | 10   | 30   | 50   | 70   | 90   |
| :------------------: | :--: | :--: | :--: | :--: | :--: |
| $F(x) = P(X \leq x)$ | 0.27 | 0.41 | 0.64 | 0.92 | 1.00 |

Now let $x_1 = 10, x_2 = 30, x_3 = 50, x_4 = 70, x_5 = 90.$

<!-- step 1. generate u ~ U(0, 1) -->
<!-- step 2. assign X = x_i if F(x_i - 1) < u <= F(x_i) -->

```{r}
set.seed(20230208)

f <- function(print_check = FALSE) {
  u <- runif(1, 0, 1)
  x <- c(10, 30, 50, 70, 90)
  p <- c(0.27, 0.41, 0.64, 0.92, 1)
  keep <- dplyr::lag(p, default = 0) < u & u <= p

  # print the check if requested
  if (print_check) print(data.frame(x, p, u, keep))

  # keep the entry of x that passes the check
  x[keep]
}

# run once as an example
f(print_check = TRUE)

# examine the distribution, take 10k samples
x <- replicate(10000, f())

x |>
  table() |>
  prop.table() |>
  cumsum() |>
  round(2)
```

\newpage
# Question 4

(a) Calculate the inverse function of $u = F(x)$, i.e., $F^{-1}_X(u) = x.$

\begin{align*}
  F(x) = u &\implies 1 - e^{-(0.25x^3)} = u \\
           &\implies 1 - u = e^{-(0.25x^3)} \\
           &\implies ln(1 - u) = -\frac{1}{4}x^3 \\
           &\implies -4ln(1 - u) = x^3 \\
           &\implies (-4ln(1 - u))^{\frac{1}{3}} = x \\
           &\implies F^{-1}_X(u) = x.
\end{align*}

(b) Calculate values of $x$ for $u = 0.37, 0.45, 0.82.$

```{r}
f_inv <- function(u) (-4*log(1 - u))^(1/3)

f_inv(c(0.37, 0.45, 0.82)) |> round(digits = 5)
```

\newpage
# Question 5

\newpage
# Question 6

$f(x) = \frac{1}{2}e^{-|x|}.$

<!-- \begin{align*}
F(x) &= \int_{-\infty}^{x} f(t)\ dt \\
     &= \frac{1}{2} \int_0^x e^{-t}\ dt \\
     &= -\frac{1}{2} e^{-t} \big|_{t = 0}^{t = x} \\
     &= -\frac{1}{2} (e^{-x} - e^0) \\
     &= frac{1}{2} - \frac{1}{2}e^{-x}.
\end{align*} -->

\newpage
# Question 7


